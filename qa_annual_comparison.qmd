---
title: "QA Annual Comparison"
format: 
  html: 
    toc: true
execute: 
  echo: false
  warning: false
editor: visual
params: 
  eGRID_year: 2023
  year_abbrev: 23
---

```{r}
#| label: set_up_file

library(ggplot2)
library(dplyr)
library(kableExtra)
```

This file compares the final output of eGRID to previous year outputs.

```{r}
#| label: read_qa_file
#| file: "scripts/qa/annual_qa/qa_egrid_annual_comparison.R"
#| warning: False
#| echo: False
#| results: False
```

# Rate comparison

## Subregion

Compare emission rates from `r prev_yr3` to `r params$eGRID_year` and percent change from `r prev_yr1` to `r params$eGRID_year`.

## Output emission rate comparison

::: panel-tabset
### NOx output rate

```{r}
#| label: nox_output_rate
#| echo: False
#| warning: False

nox_output <- 
  egrid_rate_comparison %>% select(subregion, contains("nox_output"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = nox_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### NOx ozone output rate

```{r}
#| label: nox_oz_output_rate
#| echo: False
#| warning: False

nox_oz_output <- 
  egrid_rate_comparison %>% select(subregion, contains("nox_oz_output"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = nox_oz_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_oz_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### SO2 output rate

```{r}
#| label: so2_output_rate
#| echo: False
#| warning: False

so2_output <- 
  egrid_rate_comparison %>% select(subregion, contains("so2_output"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = so2_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(so2_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### CO2 output rate

```{r}
#| label: co2_output_rate
#| echo: False
#| warning: False

co2_output <- 
  egrid_rate_comparison %>% select(subregion, contains("co2_output"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = co2_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2_output,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### CH4 output rate

```{r}
#| label: ch4_output_rate
#| echo: False
#| warning: False

ch4_output <- 
  egrid_rate_comparison %>% select(subregion, contains("ch4_output"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion,
                                                y = ch4_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(ch4_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### N2O output rate

```{r}
#| label: n2o_output_rate
#| echo: False
#| warning: False

n2o_output <- 
  egrid_rate_comparison %>% select(subregion, contains("n2o_output"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion,
                                                y = n2o_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(n2o_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### CO2e output rate

```{r}
#| label: co2e_output_rate
#| echo: False
#| warning: False

co2e_output <- 
  egrid_rate_comparison %>% select(subregion, contains("co2e_output"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = co2e_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2e_output,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

## Input emission rate comparison

::: panel-tabset
### NOx input rate

```{r}
#| label: nox_input_rate
#| echo: False
#| warning: False

nox_input <- 
  egrid_rate_comparison %>% select(subregion, contains("nox_input"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = nox_input_rate,
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### NOx ozone input rate

```{r}
#| label: nox_input_oz_rate
#| echo: False
#| warning: False

nox_oz_input <- 
  egrid_rate_comparison %>% select(subregion, contains("nox_oz_input"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = nox_oz_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_oz_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### SO2 input rate

```{r}
#| label: so2_input_rate
#| echo: False
#| warning: False

so2_input <- 
  egrid_rate_comparison %>% select(subregion, contains("so2_input"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = so2_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(so2_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### CO2 input rate

```{r}
#| label: co2_input_rate
#| echo: False
#| warning: False

co2_input <- 
  egrid_rate_comparison %>% select(subregion, contains("co2_input"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion,
                                                y = co2_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2_input,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### CH4 input rate

```{r}
#| label: ch4_input_rate
#| echo: False
#| warning: False

ch4_output <- 
  egrid_rate_comparison %>% select(subregion, contains("ch4_output"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = ch4_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(ch4_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### N2O input rate

```{r}
#| label: n2o_input_rate
#| echo: False
#| warning: False

n2o_input <- 
  egrid_rate_comparison %>% select(subregion, contains("n2o_input"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = n2o_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(n2o_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### CO2e input rate

```{r}
#| label: co2e_input_rate
#| echo: False
#| warning: False

co2e_input <- 
  egrid_rate_comparison %>% select(subregion, contains("co2e_input"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = co2e_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2e_input,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

## Combustion output emission rate comparison

::: panel-tabset
### NOx combustion output rate

```{r}
#| label: nox_combustion_rate
#| echo: False
#| warning: False

nox_combustion <- 
  egrid_rate_comparison %>% select(subregion, contains("nox_combustion"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = nox_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### NOx ozone combustion output rate

```{r}
#| label: nox_oz_combustion_rate
#| echo: False
#| warning: False

nox_oz_combustion <- 
  egrid_rate_comparison %>% select(subregion, contains("nox_oz_combustion"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion,
                                                y = nox_oz_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_oz_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### SO2 combustion output rate

```{r}
#| label: so2_combustion_rate
#| echo: False
#| warning: False

so2_combustion <- 
  egrid_rate_comparison %>% select(subregion, contains("so2_combustion"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = so2_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(so2_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### CO2 combustion output rate

```{r}
#| label: co2_combustion_rate
#| echo: False
#| warning: False

co2_combustion <- 
  egrid_rate_comparison %>% select(subregion, contains("co2_combustion"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = co2_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2_combustion,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### CH4 combustion output rate

```{r}
#| label: ch4_combustion_rate
#| echo: False
#| warning: False

ch4_combustion <- 
  egrid_rate_comparison %>% select(subregion, contains("ch4_combustion"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = ch4_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(ch4_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### N2O combustion output rate

```{r}
#| label: n2o_combustion_rate
#| echo: False
#| warning: False

n2o_combustion <- 
  egrid_rate_comparison %>% select(subregion, contains("n2o_combustion"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = n2o_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(n2o_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

### CO2e combustion output rate

```{r}
#| label: co2e_combustion_rate
#| echo: False
#| warning: False

co2e_combustion <- 
  egrid_rate_comparison %>% select(subregion, contains("co2e_combustion"), generation_notes)

rate_comparison <- ggplot(egrid_us_comparison, aes(x = subregion, 
                                                y = co2e_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2e_combustion,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

## ADD STATE HERE
- include nonbaseload outut rates for both subregion and state levels
- include fuel-specific input emission rates and output emission rates for both subgregion and state level
- 

# Resource mix comparison

- move graphs to able

## US resource mix

::: panel-tabset
### US resource mix table

```{r}
#| label: US_resource_mix_table 
#| echo: false 
#| warning: false  

knitr::kable(us_resource_mix_formatted,
             digits = 2, 
             format.args = list(big.mark = ","), 
             col.names = gsub("[_]", " ", names(us_resource_mix_formatted))) %>%
  row_spec(1, background = "#ffefd5") %>% 
  column_spec(6,
              background = case_when(us_resource_mix_formatted$percent_change 
                                     > 0 ~ "#e9ffdb", 
                                     us_resource_mix_formatted$percent_change 
                                     == 0 ~ "#dcdcdc", 
                                     us_resource_mix_formatted$percent_change 
                                     < 0 ~ "#f7bfbe"), 
              color = case_when(us_resource_mix_formatted$percent_change 
                                > 0 ~ "#013220", 
                                us_resource_mix_formatted$percent_change 
                                == 0 ~ "#000000", 
                                us_resource_mix_formatted$percent_change 
                                < 0 ~ "#860111"))  
  
```

### US resource mix figure

```{r}
#| label: US_resource_mix_figure
#| echo: false 
#| warning: false  

resource_comparison <-    
  ggplot(us_resource_mix, 
         aes(x = energy_source_generation / 1000,               
           y = reorder(energy_source, energy_source_generation), fill = year)) +
  geom_bar(stat = "identity",
           width = 0.75,
           position = "dodge") +   
  xlab("Generation (GWh)") +    
  ylab("Energy source") +    
  theme(text = element_text(size = 12))     

plotly::ggplotly(resource_comparison)
```
:::

## eGRID subregion resource mix

::: panel-tabset
### AKGD

```{r}
#| label: AKGD_summary
#| echo: false
#| warning: false

source("scripts/functions/function_region_summary.R")

create_cap_table_egrid("AKGD", c(prev_yr1, cur_year))
create_resource_table_egrid("AKGD", c(prev_yr1, cur_year))
create_resource_plot_egrid("AKGD", c(prev_yr1, cur_year))
```

### AKMS

```{r}
#| label: AKMS_summary
#| echo: false
#| warning: false

create_cap_table_egrid("AKMS", c(prev_yr1, cur_year))
create_resource_table_egrid("AKMS", c(prev_yr1, cur_year))
create_resource_plot_egrid("AKMS", c(prev_yr1, cur_year))
```

### AZNM

```{r}
#| label: AZNM_summary
#| echo: false
#| warning: false

create_cap_table_egrid("AZNM", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("AZNM", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("AKMS", 
                           c(prev_yr1, cur_year))
```

### CAMX

```{r}
#| label: CAMX_summary
#| echo: false
#| warning: false

create_cap_table_egrid("CAMX", c(prev_yr1, cur_year))
create_resource_table_egrid("CAMX", c(prev_yr1, cur_year))
create_resource_plot_egrid("CAMX", c(prev_yr1, cur_year))
```

### ERCT

```{r}
#| label: ERCT_summary
#| echo: false
#| warning: false

create_cap_table_egrid("ERCT", c(prev_yr1, cur_year))
create_resource_table_egrid("ERCT", c(prev_yr1, cur_year))
create_resource_plot_egrid("ERCT", c(prev_yr1, cur_year))
```

### FRCC

```{r}
#| label: FRCC_summary
#| echo: false
#| warning: false

create_cap_table_egrid("FRCC", c(prev_yr1, cur_year))
create_resource_table_egrid("FRCC", c(prev_yr1, cur_year))
create_resource_plot_egrid("FRCC", c(prev_yr1, cur_year))
```

### HIMS

```{r}
#| label: HIMS_summary
#| echo: false
#| warning: false

create_cap_table_egrid("HIMS", c(prev_yr1, cur_year))
create_resource_table_egrid("HIMS", c(prev_yr1, cur_year))
create_resource_plot_egrid("HIMS", c(prev_yr1, cur_year))
```

### HIOA

```{r}
#| label: HIOA_summary
#| echo: false
#| warning: false

create_cap_table_egrid("HIOA", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("HIOA", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("HIOA", 
                           c(prev_yr1, cur_year))
```

### MROE

```{r}
#| label: MROE_summary
#| echo: false
#| warning: false

create_cap_table_egrid("MROE", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("MROE", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("MROE", 
                           c(prev_yr1, cur_year))
```

### MROW

```{r}
#| label: MROW_summary
#| echo: false
#| warning: false

create_cap_table_egrid("MROW", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("MROW", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("MROW", 
                           c(prev_yr1, cur_year))
```

### NEWE

```{r}
#| label: NEWE_summary
#| echo: false
#| warning: false

create_cap_table_egrid("NEWE", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("NEWE", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("NEWE", 
                           c(prev_yr1, cur_year))
```

### NWPP

```{r}
#| label: NWPP_summary
#| echo: false
#| warning: false

create_cap_table_egrid("NWPP", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("NWPP", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("NWPP", 
                           c(prev_yr1, cur_year))
```

### NYCW

```{r}
#| label: NYCW_summary
#| echo: false
#| warning: false

create_cap_table_egrid("NYCW", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("NYCW", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("NYCW", 
                           c(prev_yr1, cur_year))
```

### NYLI

```{r}
#| label: NYLI_summary
#| echo: false
#| warning: false

create_cap_table_egrid("NYLI",
                       c(prev_yr1, cur_year))
create_resource_table_egrid("NYLI", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("NYLI", 
                           c(prev_yr1, cur_year))
```

### NYUP

```{r}
#| label: NYUP_summary
#| echo: false
#| warning: false

create_cap_table_egrid("NYUP", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("NYUP", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("NYUP", 
                           c(prev_yr1, cur_year))
```

### PRMS

```{r}
#| label: PRMS_summary
#| echo: false
#| warning: false

create_cap_table_egrid("PRMS", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("PRMS", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("PRMS", 
                           c(prev_yr1, cur_year))
```

### RFCE

```{r}
#| label: RFCE_summary
#| echo: false
#| warning: false

create_cap_table_egrid("RFCE", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("RFCE", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("RFCE", 
                           c(prev_yr1, cur_year))
```

### RFCM

```{r}
#| label: RFCM_summary
#| echo: false
#| warning: false

create_cap_table_egrid("RFCM", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("RFCM", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("RFCM", 
                           c(prev_yr1, cur_year))
```

### RFCW

```{r}
#| label: RFCW_summary
#| echo: false
#| warning: false

create_cap_table_egrid("RFCW", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("RFCW", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("RFCW", 
                           c(prev_yr1, cur_year))
```

### RMPA

```{r}
#| label: RMPA_summary
#| echo: false
#| warning: false

create_cap_table_egrid("RMPA", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("RMPA", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("RMPA", 
                           c(prev_yr1, cur_year))
```

### SPNO

```{r}
#| label: SPNO_summary
#| echo: false
#| warning: false

create_cap_table_egrid("SPNO", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("SPNO", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("SPNO", 
                           c(prev_yr1, cur_year))
```

### SPSO

```{r}
#| label: SPSO_summary
#| echo: false
#| warning: false

create_cap_table_egrid("SPSO", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("SPSO", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("SPSO", 
                           c(prev_yr1, cur_year))
```

### SRMV

```{r}
#| label: SRMV_summary
#| echo: false
#| warning: false

create_cap_table_egrid("SRMV", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("SRMV", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("SRMV", 
                           c(prev_yr1, cur_year))
```

### SRSO

```{r}
#| label: SRSO_summary
#| echo: false
#| warning: false

create_cap_table_egrid("SRSO", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("SRSO", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("SRSO", 
                           c(prev_yr1, cur_year))
```

### SRTV

```{r}
#| label: SRTV_summary
#| echo: false
#| warning: false

create_cap_table_egrid("SRTV", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("SRTV", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("SRTV", 
                           c(prev_yr1, cur_year))
```

### SRVC

```{r}
#| label: SRVC_summary
#| echo: false
#| warning: false

create_cap_table_egrid("SRVC", 
                       c(prev_yr1, cur_year))
create_resource_table_egrid("SRVC", 
                            c(prev_yr1, cur_year))
create_resource_plot_egrid("SRVC", 
                           c(prev_yr1, cur_year))
```
:::

## State resource mix

::: panel-tabset
### AK

```{r}
#| label: AK_summary
#| echo: false
#| warning: false

create_cap_table_state("AK", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AK", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("AK", 
                           c(prev_yr1, cur_year))
```

### AL

```{r}
#| label: AL_summary
#| echo: false
#| warning: false

create_cap_table_state("AL", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AL", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("AL", 
                           c(prev_yr1, cur_year))
```

### AR

```{r}
#| label: AR_summary
#| echo: false
#| warning: false

create_cap_table_state("AR", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AR", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("AR", 
                           c(prev_yr1, cur_year))
```

### AZ

```{r}
#| label: AZ_summary
#| echo: false
#| warning: false

create_cap_table_state("AZ", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AZ", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("AZ", 
                           c(prev_yr1, cur_year))
```

### CA

```{r}
#| label: CA_summary
#| echo: false
#| warning: false

create_cap_table_state("CA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("CA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("CA", 
                           c(prev_yr1, cur_year))
```

### CO

```{r}
#| label: CO_summary
#| echo: false
#| warning: false

create_cap_table_state("CO", 
                       c(prev_yr1, cur_year))
create_resource_table_state("CO", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("CO", 
                           c(prev_yr1, cur_year))
```

### CT

```{r}
#| label: CT_summary
#| echo: false
#| warning: false

create_cap_table_state("CT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("CT", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("CT", 
                           c(prev_yr1, cur_year))
```

### DC

```{r}
#| label: DC_summary
#| echo: false
#| warning: false

create_cap_table_state("DC", 
                       c(prev_yr1, cur_year))
create_resource_table_state("DC", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("DC", 
                           c(prev_yr1, cur_year))
```

### DE

```{r}
#| label: DE_summary
#| echo: false
#| warning: false

create_cap_table_state("DE", 
                       c(prev_yr1, cur_year))
create_resource_table_state("DE", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("DE", 
                           c(prev_yr1, cur_year))
```

### FL

```{r}
#| label: FL_summary
#| echo: false
#| warning: false

create_cap_table_state("FL", 
                       c(prev_yr1, cur_year))
create_resource_table_state("FL", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("FL", 
                           c(prev_yr1, cur_year))
```

### GA

```{r}
#| label: GA_summary
#| echo: false
#| warning: false

create_cap_table_state("GA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("GA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("GA", 
                           c(prev_yr1, cur_year))
```

### HI

```{r}
#| label: HI_summary
#| echo: false
#| warning: false

create_cap_table_state("HI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("HI", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("HI", 
                           c(prev_yr1, cur_year))
```

### IA

```{r}
#| label: IA_summary
#| echo: false
#| warning: false

create_cap_table_state("IA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("IA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("IA", 
                           c(prev_yr1, cur_year))
```

### ID

```{r}
#| label: ID_summary
#| echo: false
#| warning: false

create_cap_table_state("ID", 
                       c(prev_yr1, cur_year))
create_resource_table_state("ID", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("ID", 
                           c(prev_yr1, cur_year))
```

### IL

```{r}
#| label: IL_summary
#| echo: false
#| warning: false

create_cap_table_state("IL", 
                       c(prev_yr1, cur_year))
create_resource_table_state("IL", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("IL", 
                           c(prev_yr1, cur_year))
```

### IN

```{r}
#| label: IN_summary
#| echo: false
#| warning: false

create_cap_table_state("IN", 
                       c(prev_yr1, cur_year))
create_resource_table_state("IN", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("IN", 
                           c(prev_yr1, cur_year))
```

### KS

```{r}
#| label: KS_summary
#| echo: false
#| warning: false

create_cap_table_state("KS", 
                       c(prev_yr1, cur_year))
create_resource_table_state("KS", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("KS", 
                           c(prev_yr1, cur_year))
```

### KY

```{r}
#| label: KY_summary
#| echo: false
#| warning: false

create_cap_table_state("KY", 
                       c(prev_yr1, cur_year))
create_resource_table_state("KY", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("KY", 
                           c(prev_yr1, cur_year))
```

### LA

```{r}
#| label: LA_summary
#| echo: false
#| warning: false

create_cap_table_state("LA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("LA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("LA", 
                           c(prev_yr1, cur_year))
```

### MA

```{r}
#| label: MA_summary
#| echo: false
#| warning: false

create_cap_table_state("MA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MA", 
                           c(prev_yr1, cur_year))
```

### MD

```{r}
#| label: MD_summary
#| echo: false
#| warning: false

create_cap_table_state("MD", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MD", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MD", 
                           c(prev_yr1, cur_year))
```

### ME

```{r}
#| label: ME_summary
#| echo: false
#| warning: false

create_cap_table_state("ME", 
                       c(prev_yr1, cur_year))
create_resource_table_state("ME", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("ME", 
                           c(prev_yr1, cur_year))
```

### MI

```{r}
#| label: MI_summary
#| echo: false
#| warning: false

create_cap_table_state("MI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MI", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MI", 
                           c(prev_yr1, cur_year))
```

### MN

```{r}
#| label: MN_summary
#| echo: false
#| warning: false

create_cap_table_state("MN", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MN", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MN", 
                           c(prev_yr1, cur_year))
```

### MO

```{r}
#| label: MO_summary
#| echo: false
#| warning: false

create_cap_table_state("MO", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MO", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MO", 
                           c(prev_yr1, cur_year))
```

### MS

```{r}
#| label: MS_summary
#| echo: false
#| warning: false

create_cap_table_state("MS", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MS", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MS", 
                           c(prev_yr1, cur_year))
```

### MT

```{r}
#| label: MT_summary
#| echo: false
#| warning: false

create_cap_table_state("MT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MT", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MT", 
                           c(prev_yr1, cur_year))
```

### NC

```{r}
#| label: NC_summary
#| echo: false
#| warning: false

create_cap_table_state("NC", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NC", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NC", 
                           c(prev_yr1, cur_year))
```

### ND

```{r}
#| label: ND_summary
#| echo: false
#| warning: false

create_cap_table_state("ND", 
                       c(prev_yr1, cur_year))
create_resource_table_state("ND", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("ND", 
                           c(prev_yr1, cur_year))
```

### NE

```{r}
#| label: NE_summary
#| echo: false
#| warning: false

create_cap_table_state("NE", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NE", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NE", 
                           c(prev_yr1, cur_year))
```

### NH

```{r}
#| label: NH_summary
#| echo: false
#| warning: false

create_cap_table_state("NH", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NH", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NH", 
                           c(prev_yr1, cur_year))
```

### NJ

```{r}
#| label: NJ_summary
#| echo: false
#| warning: false

create_cap_table_state("NJ", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NJ", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NJ", 
                           c(prev_yr1, cur_year))
```

### NM

```{r}
#| label: NM_summary
#| echo: false
#| warning: false

create_cap_table_state("NM", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NM", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NM", 
                           c(prev_yr1, cur_year))
```

### NV

```{r}
#| label: NV_summary
#| echo: false
#| warning: false

create_cap_table_state("NV", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NV", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NV",
                           c(prev_yr1, cur_year))
```

### NY

```{r}
#| label: NY_summary
#| echo: false
#| warning: false

create_cap_table_state("NY", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NY", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NY", 
                           c(prev_yr1, cur_year))
```

### OH

```{r}
#| label: OH_summary
#| echo: false
#| warning: false

create_cap_table_state("OH", c(prev_yr1, cur_year))
create_resource_table_state("OH", c(prev_yr1, cur_year))
create_resource_plot_state("OH", c(prev_yr1, cur_year))
```

### OK

```{r}
#| label: OK_summary
#| echo: false
#| warning: false

create_cap_table_state("OK", 
                       c(prev_yr1, cur_year))
create_resource_table_state("OK", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("OK", 
                           c(prev_yr1, cur_year))
```

### OR

```{r}
#| label: OR_summary
#| echo: false
#| warning: false

create_cap_table_state("OR", 
                       c(prev_yr1, cur_year))
create_resource_table_state("OR", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("OR", 
                           c(prev_yr1, cur_year))
```

### PA

```{r}
#| label: PA_summary
#| echo: false
#| warning: false

create_cap_table_state("PA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("PA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("PA", 
                           c(prev_yr1, cur_year))
```

### PR

```{r}
#| label: PR_summary
#| echo: false
#| warning: false

create_cap_table_state("PR", 
                       c(prev_yr1, cur_year))
create_resource_table_state("PR", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("PR", 
                           c(prev_yr1, cur_year))
```

### RI

```{r}
#| label: RI_summary
#| echo: false
#| warning: false

create_cap_table_state("RI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("RI", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("RI", 
                           c(prev_yr1, cur_year))
```

### SC

```{r}
#| label: SC_summary
#| echo: false
#| warning: false

create_cap_table_state("SC", 
                       c(prev_yr1, cur_year))
create_resource_table_state("SC", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("SC", 
                           c(prev_yr1, cur_year))
```

### SD

```{r}
#| label: SD_summary
#| echo: false
#| warning: false

create_cap_table_state("SD", 
                       c(prev_yr1, cur_year))
create_resource_table_state("SD", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("SD", 
                           c(prev_yr1, cur_year))
```

### TN

```{r}
#| label: TN_summary
#| echo: false
#| warning: false

create_cap_table_state("TN", 
                       c(prev_yr1, cur_year))
create_resource_table_state("TN", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("TN", 
                           c(prev_yr1, cur_year))
```

### TX

```{r}
#| label: TX_summary
#| echo: false
#| warning: false

create_cap_table_state("TX", 
                       c(prev_yr1, cur_year))
create_resource_table_state("TX", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("TX", 
                           c(prev_yr1, cur_year))
```

### UT

```{r}
#| label: UT_summary
#| echo: false
#| warning: false

create_cap_table_state("UT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("UT", c(prev_yr1, cur_year))
create_resource_plot_state("UT", c(prev_yr1, cur_year))
```

### VA

```{r}
#| label: VA_summary
#| echo: false
#| warning: false

create_cap_table_state("VA", c(prev_yr1, cur_year))
create_resource_table_state("VA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("VA", 
                           c(prev_yr1, cur_year))
```

### VT

```{r}
#| label: VT_summary
#| echo: false
#| warning: false

create_cap_table_state("VT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("VT", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("VT", 
                           c(prev_yr1, cur_year))
```

### WA

```{r}
#| label: WA_summary
#| echo: false
#| warning: false

create_cap_table_state("WA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("WA", 
                           c(prev_yr1, cur_year))
```

### WI

```{r}
#| label: WI_summary
#| echo: false
#| warning: false

create_cap_table_state("WI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WI", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("WI", 
                           c(prev_yr1, cur_year))
```

### WV

```{r}
#| label: WV_summary
#| echo: false
#| warning: false

create_cap_table_state("WV", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WV", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("WV", 
                           c(prev_yr1, cur_year))
```

### WY

```{r}
#| label: WY_summary
#| echo: false
#| warning: false

create_cap_table_state("WY", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WY", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("WY", 
                           c(prev_yr1, cur_year))
```
:::

---
title: "QA Annual Comparison"
format: 
  html: 
    toc: true
    toc-expand: true
    toc-depth: 4
    toc-location: left
execute: 
  echo: false
  warning: false
editor: visual
params: 
  eGRID_year: 2023
  year_abbrev: 23
---

```{r}
#| label: set-up-file

library(ggplot2)
library(dplyr)
library(kableExtra)
```

This file compares the final output of eGRID to previous year outputs.

```{r}
#| label: read-qa-file
#| file: "scripts/qa/annual_qa/qa_egrid_annual_comparison.R"


#| results: False
```

# Rate comparison

## Subregion

Compare subregion emission rates from `r prev_yr3` to `r params$eGRID_year` and percent change from `r prev_yr1` to `r params$eGRID_year`.

### Output emission rate comparison
#### Emission types

::: panel-tabset

##### NOx output rate

```{r}
#| label: nox-output-rate-subregion

nox_output <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_output_rate_2"), nox_output_rate_pct,  
         generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### NOx ozone output rate

```{r}
#| label: nox-oz-output-rate-subregion

nox_oz_output <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_oz_output_rate_2"),
                                       nox_oz_output_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### SO2 output rate

```{r}
#| label: so2-output-rate-subregion

so2_output <- 
  subregion_rate_comparison %>% select(subregion, contains("so2_output_rate_2"),
                                       so2_output_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent Change",
                           "Notes")) 
```

##### CO2 output rate

```{r}
#| label: co2-output-rate-subregion

co2_output <- 
  subregion_rate_comparison %>% select(subregion, contains("co2_output_rate_2"),
                                       co2_output_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_output,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### CH4 output rate

```{r}
#| label: ch4-output-rate-subregion

ch4_output <- 
  subregion_rate_comparison %>% select(subregion, contains("ch4_output_rate_2"),
                                      ch4_output_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion,
                                                y = ch4_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### N2O output rate

```{r}
#| label: n2o-output-rate-subregion

n2o_output <- 
  subregion_rate_comparison %>% select(subregion, contains("n2o_output_rate_2"),
                                       n2o_output_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion,
                                                y = n2o_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### CO2e output rate

```{r}
#| label: co2e-output-rate-subregion

co2e_output <- 
  subregion_rate_comparison %>% select(subregion, contains("co2e_output_rate_2"),
                                       co2e_output_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_output,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

#### Fuel types

::: panel-tabset
##### Coal output rate

```{r}
#| label: coal-output-rate-subregion

coal_output <- 
  subregion_rate_comparison %>% select(subregion, contains("coal_output_rate"))

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = coal_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Coal output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(coal_output,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Oil output rate

```{r}
#| label: oil-output-rate-subregion

oil_output <- 
  subregion_rate_comparison %>% select(subregion, contains("oil_output_rate"))

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = oil_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Oil output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(oil_output,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Gas output rate

```{r}
#| label: gas-output-rate-subregion

gas_output <- 
  subregion_rate_comparison %>% select(subregion, contains("gas_output_rate"))

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = gas_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Gas output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(gas_output,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Fossil fuel input rate

```{r}
#| label: fossil-output-rate-subregion

fossil_output <- 
  subregion_rate_comparison %>% select(subregion, contains("fossil_output_rate"))

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = fossil_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Fossil fuel output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(fossil_output,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```
:::

##### NOx fuel types

::: panel-tabset
###### NOx coal output rate

```{r}
#| label: nox-output-rate-coal-subregion

nox_output_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx coal output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### NOx oil output rate

```{r}
#| label: nox-output-rate-oil-subregion

nox_output_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx oil output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx gas output rate

```{r}
#| label: nox-output-rate-gas-subregion

nox_output_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx gas output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx fossil fuel output rate

```{r}
#| label: nox-output-rate-fossil-subregion

nox_output_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx fossil fuel output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### NOx ozone fuel types

::: panel-tabset
###### NOx ozone coal output rate

```{r}
#| label: nox-oz-output-rate-coal-subregion

nox_oz_output_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_oz_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx coal output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### NOx oil output rate

```{r}
#| label: nox-oz-output-rate-oil-subregion

nox_oz_output_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_oz_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx oil output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx gas output rate

```{r}
#| label: nox-oz-output-rate-gas-subregion

nox_oz_output_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_oz_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx gas output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx fossil fuel output rate

```{r}
#| label: nox-oz-output-rate-fossil-subregion

nox_oz_output_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_oz_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx fossil fuel output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### SO2 fuel types

::: panel-tabset
###### SO2 coal output rate

```{r}
#| label: so2-output-rate-coal-subregion

so2_output_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("so2_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 coal output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### SO2 oil output rate

```{r}
#| label: so2-output-rate-oil-subregion

so2_output_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("so2_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 oil output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### SO2 gas output rate

```{r}
#| label: so2-output-rate-gas-subregion

so2_output_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("so2_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 gas output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### SO2 fossil fuel output rate

```{r}
#| label: so2-output-rate-fossil-subregion

so2_output_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("so2_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 fossil fuel output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CO2 fuel types

::: panel-tabset
###### CO2 coal output rate

```{r}
#| label: co2-output-rate-coal-subregion

co2_output_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 coal output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CO2 oil output rate

```{r}
#| label: co2-output-rate-oil-subregion

co2_output_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 oil output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>%   
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2 gas output rate

```{r}
#| label: co2-output-rate-gas-subregion

co2_output_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 gas output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2 fossil fuel output rate

```{r}
#| label: co2-output-rate-fossil-subregion

co2_output_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 fossil fuel output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CH4 fuel types

::: panel-tabset
###### CH4 coal output rate

```{r}
#| label: ch4-output-rate-coal-subregion

ch4_output_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("ch4_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 coal output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CH4 oil output rate

```{r}
#| label: ch4-output-rate-oil-subregion

ch4_output_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("ch4_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 oil output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CH4 gas output rate

```{r}
#| label: ch4-output-rate-gas-subregion

ch4_output_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("ch4_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 gas output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CH4 fossil fuel output rate

```{r}
#| label: ch4-output-rate-fossil-subregion

ch4_output_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("ch4_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 fossil fuel output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### N2O fuel types

::: panel-tabset
###### N2O coal output rate

```{r}
#| label: n2o-output-rate-coal-subregion

n2o_output_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("n2o_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O coal output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### N2O oil output rate

```{r}
#| label: n2o-output-rate-oil-subregion

n2o_output_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("n2o_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O oil output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### N2O gas output rate

```{r}
#| label: n2o-output-rate-gas-subregion

n2o_output_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("n2o_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O gas output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### N2O fossil fuel output rate

```{r}
#| label: n2o-output-rate-fossil-subregion

n2o_output_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("n2o_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O fossil fuel output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CO2e fuel types

::: panel-tabset
###### CO2e coal output rate

```{r}
#| label: co2e-output-rate-coal-subregion

co2e_output_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2e_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e coal output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CO2e oil output rate

```{r}
#| label: co2e-output-rate-oil-subregion

co2e_output_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2e_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e oil output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2e gas output rate

```{r}
#| label: co2e-output-rate-gas-subregion

co2e_output_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2e_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e gas output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2e fossil fuel output rate

```{r}
#| label: co2e-output-rate-fossil-subregion

co2e_output_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2e_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e fossil fuel output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

### Input emission rate comparison

#### Emission type

::: panel-tabset
##### NOx input rate

```{r}
#| label: nox-input-rate-subregion

nox_input <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_input_rate_2"),
                                      nox_input_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_input_rate,
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### NOx ozone input rate

```{r}
#| label: nox-input-oz-rate-subregion

nox_oz_input <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_oz_input_rate_2"),
                                      nox_oz_input_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### SO2 input rate

```{r}
#| label: so2-input-rate-subregion

so2_input <- 
  subregion_rate_comparison %>% select(subregion, contains("so2_input_rate_2"),
                                       so2_input_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### CO2 input rate

```{r}
#| label: co2-input-rate-subregion

co2_input <- 
  subregion_rate_comparison %>% select(subregion, contains("co2_input_rate_2"),
                                       co2_input_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion,
                                                y = co2_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_input,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### CH4 input rate

```{r}
#| label: ch4-input-rate-subregion

ch4_output <- 
  subregion_rate_comparison %>% select(subregion, contains("ch4_output_rate_2"),
                                       ch4_input_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### N2O input rate

```{r}
#| label: n2o-input-rate-subregion

n2o_input <- 
  subregion_rate_comparison %>% select(subregion, contains("n2o_input_rate_2"),
                                       n2o_input_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### CO2e input rate

```{r}
#| label: co2e-input-rate-subregion

co2e_input <- 
  subregion_rate_comparison %>% select(subregion, contains("co2e_input_rate_2"),
                                       co2e_input_rate_pct, generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_input,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

#### Fuel types

::: panel-tabset

##### Coal input rate

```{r}
#| label: coal-input-rate-subregion

coal_input <- 
  subregion_rate_comparison %>% select(subregion, contains("coal_input_rate"))

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = coal_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Coal input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(coal_input,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Oil input rate

```{r}
#| label: oil-input-rate-subregion

oil_input <- 
  subregion_rate_comparison %>% select(subregion, contains("oil_input_rate"))

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = oil_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Oil input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(oil_input,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Gas input rate

```{r}
#| label: gas-input-rate-subregion

gas_input <- 
  subregion_rate_comparison %>% select(subregion, contains("gas_input_rate"))

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = gas_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Gas input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(gas_input,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Fossil fuel input rate

```{r}
#| label: fossil-input-rate-subregion

fossil_input <- 
  subregion_rate_comparison %>% select(subregion, contains("fossil_input_rate"))

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = fossil_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Fossil fuel input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(fossil_input,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```
:::

##### NOx fuel types

::: panel-tabset
###### NOx coal input rate

```{r}
#| label: nox-input-rate-coal-subregion

nox_input_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx coal input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### NOx oil input rate

```{r}
#| label: nox-input-rate-oil-subregion

nox_input_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx oil input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx gas input rate

```{r}
#| label: nox-input-rate-gas-subregion-subregion

nox_input_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx gas input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx fossil fuel input rate

```{r}
#| label: nox-input-rate-fossil-subregion

nox_input_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx fossil fuel input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### NOx ozone fuel types

::: panel-tabset
###### NOx ozone coal input rate

```{r}
#| label: nox-oz-input-rate-coal-subregion

nox_oz_input_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_oz_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx coal input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### NOx oil input rate

```{r}
#| label: nox-oz-input-rate-oil-subregion

nox_oz_input_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_oz_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx oil input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx gas input rate

```{r}
#| label: nox-oz-input-rate-gas-subregion

nox_oz_input_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_oz_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx gas input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx fossil fuel input rate

```{r}
#| label: nox-oz-input-rate-fossil-subregion

nox_oz_input_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_oz_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx fossil fuel input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### SO2 fuel types

::: panel-tabset
###### SO2 coal input rate

```{r}
#| label: so2-input-rate-coal-subregion

so2_input_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("so2_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 coal input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### SO2 oil input rate

```{r}
#| label: so2-input-rate-oil-subregion

so2_input_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("so2_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 oil input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### SO2 gas input rate

```{r}
#| label: so2-input-rate-gas-subregion

so2_input_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("so2_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 gas input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### SO2 fossil fuel input rate

```{r}
#| label: so2-input-rate-fossil-subregion

so2_input_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("so2_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 fossil fuel input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CO2 fuel types

::: panel-tabset
###### CO2 coal input rate

```{r}
#| label: co2-input-rate-coal-subregion

co2_input_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 coal input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CO2 oil input rate

```{r}
#| label: co2-input-rate-oil-subregion

co2_input_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 oil input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2 gas input rate

```{r}
#| label: co2-input-rate-gas-subregion

co2_input_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 gas input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2 fossil fuel input rate

```{r}
#| label: co2-input-rate-fossil-subregion

co2_input_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 fossil fuel input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CH4 fuel types

::: panel-tabset
###### CH4 coal input rate

```{r}
#| label: ch4-input-rate-coal-subregion

ch4_input_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("ch4_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 coal input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CH4 oil input rate

```{r}
#| label: ch4-input-rate-oil-subregion

ch4_input_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("ch4_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 oil input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CH4 gas input rate

```{r}
#| label: ch4-input-rate-gas-subregion

ch4_input_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("ch4_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 gas input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CH4 fossil fuel input rate

```{r}
#| label: ch4-input-rate-fossil-subregion

ch4_input_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("ch4_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 fossil fuel input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### N2O fuel types

::: panel-tabset
###### N2O coal input rate

```{r}
#| label: n2o-input-rate-coal-subregion

n2o_input_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("n2o_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O coal input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### N2O oil input rate

```{r}
#| label: n2o-input-rate-oil-subregion

n2o_input_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("n2o_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O oil input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### N2O gas input rate

```{r}
#| label: n2o-input-rate-gas-subregion

n2o_input_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("n2o_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O gas input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### N2O fossil fuel input rate

```{r}
#| label: n2o-input-rate-fossil-subregion

n2o_input_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("n2o_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O fossil fuel input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CO2e fuel types

::: panel-tabset
###### CO2e coal input rate

```{r}
#| label: co2e-input-rate-coal

co2e_input_coal <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2e_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e coal input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CO2e oil input rate

```{r}
#| label: co2e-input-rate-oil-subregion

co2e_input_oil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2e_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e oil input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2e gas input rate

```{r}
#| label: co2e-input-rate-gas-subregion

co2e_input_gas <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2e_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e gas input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2e fossil fuel input rate

```{r}
#| label: co2e-input-rate-fossil-subregion

co2e_input_fossil <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("co2e_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e fossil fuel input rate (lb/MMBtu)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

### Combustion output emission rate comparison

::: panel-tabset
#### NOx combustion output rate

```{r}
#| label: nox-combustion-rate-subregion

nox_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_combustion"),
                                      generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx combustion output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### NOx ozone combustion output rate

```{r}
#| label: nox-oz-combustion-rate-subregion

nox_oz_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_oz_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion,
                                                y = nox_oz_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone combustion output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### SO2 combustion output rate

```{r}
#| label: so2-combustion-rate-subregion

so2_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("so2_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 combustion output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2 combustion output rate

```{r}
#| label: co2-combustion-rate-subregion

co2_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("co2_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 combustion output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_combustion,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CH4 combustion output rate

```{r}
#| label: ch4-combustion-rate-subregion

ch4_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("ch4_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 combustion output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### N2O combustion output rate

```{r}
#| label: n2o-combustion-rate-subregion

n2o_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("n2o_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O combustion output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2e combustion output rate

```{r}
#| label: co2e-combustion-rate-subregion

co2e_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("co2e_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e combustion output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_combustion,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

### Nonbaseload output emission rate comparison

::: panel-tabset
#### NOx nonbaseload output rate

```{r}
#| label: nox-nonbaseload-rate-subregion

nox_nonbaseload <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_nonbaseload"), generation_notes)

rate_comparison <- ggplot(subregion_comparison, aes(x = subregion, 
                                                y = nox_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx nonbaseload output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_nonbaseload,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### NOx ozone nonbaseload output rate

```{r}
#| label: nox-oz-nonbaseload-rate-subregion

nox_oz_nonbaseload <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_oz_nonbaseload"), generation_notes)

rate_comparison <- ggplot(subregion_comparison, aes(x = subregion,
                                                y = nox_oz_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone nonbaseload output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_nonbaseload,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### SO2 nonbaseload output rate

```{r}
#| label: so2-nonbaseload-rate-subregion

so2_nonbaseload <- 
  subregion_rate_comparison %>% select(subregion, contains("so2_nonbaseload"), generation_notes)

rate_comparison <- ggplot(subregion_comparison, aes(x = subregion, 
                                                y = so2_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 nonbaseload output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_nonbaseload,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2 nonbaseload output rate

```{r}
#| label: co2-nonbaseload-rate-subregion

co2_nonbaseload <- 
  subregion_rate_comparison %>% select(subregion, contains("co2_nonbaseload"), generation_notes)

rate_comparison <- ggplot(subregion_comparison, aes(x = subregion, 
                                                y = co2_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 nonbaseload output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_nonbaseload,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CH4 nonbaseload output rate

```{r}
#| label: ch4-nonbaseload-rate-subregion

ch4_nonbaseload <- 
  subregion_rate_comparison %>% select(subregion, contains("ch4_nonbaseload"), generation_notes)

rate_comparison <- ggplot(subregion_comparison, aes(x = subregion, 
                                                y = ch4_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 nonbaseload output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_nonbaseload,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### N2O nonbaseload output rate

```{r}
#| label: n2o-nonbaseload-rate-subregion

n2o_nonbaseload <- 
  subregion_rate_comparison %>% select(subregion, contains("n2o_nonbaseload"), generation_notes)

rate_comparison <- ggplot(subregion_comparison, aes(x = subregion, 
                                                y = n2o_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O nonbaseload output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_nonbaseload,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2e nonbaseload output rate

```{r}
#| label: co2e-nonbaseload-rate-subregion

co2e_nonbaseload <- 
  subregion_rate_comparison %>% select(subregion, contains("co2e_nonbaseload"), generation_notes)

rate_comparison <- ggplot(subregion_comparison, aes(x = subregion, 
                                                y = co2e_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e nonbaseload output rate (lb/MWh)") + 
                    xlab("Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_nonbaseload,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

## State 

Compare state emission rates from `r prev_yr3` to `r params$eGRID_year` and percent change from `r prev_yr1` to `r params$eGRID_year`.

### Output emission rate comparison
#### Emission type 

::: panel-tabset
##### NOx output rate

```{r}
#| label: nox-output-rate-state

nox_output <- 
  state_rate_comparison %>% 
  select(state, contains("nox_output_rate_2"), nox_output_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70),
                          legend.position = "top") 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### NOx ozone output rate

```{r}
#| label: nox-oz-output-rate-state

nox_oz_output <- 
  state_rate_comparison %>% select(state, contains("nox_oz_output_rate_2"),
                                   nox_oz_output_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### SO2 output rate

```{r}
#| label: so2-output-rate-state

so2_output <- 
  state_rate_comparison %>% select(state, contains("so2_output_rate_2"),
                                   so2_output_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent Change",
                           "Notes")) 
```

##### CO2 output rate

```{r}
#| label: co2-output-rate-state

co2_output <- 
  state_rate_comparison %>% select(state, contains("co2_output_rate_2"),
                                   co2_output_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_output,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### CH4 output rate

```{r}
#| label: ch4-output-rate-state

ch4_output <- 
  state_rate_comparison %>% select(state, contains("ch4_output_rate_2"),
                                   ch4_output_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state,
                                                y = ch4_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### N2O output rate

```{r}
#| label: n2o-output-rate-state

n2o_output <- 
  state_rate_comparison %>% select(state, contains("n2o_output_rate_2"),
                                   n2o_output_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state,
                                                y = n2o_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### CO2e output rate

```{r}
#| label: co2e-output-rate-state

co2e_output <- 
  state_rate_comparison %>% select(state, contains("co2e_output_rate_2"),
                                   co2e_output_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state,
                                                y = co2e_output_rate,
                                                fill = year)) +
                    geom_bar(stat = "identity",
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e output rate (lb/MWh)") +
                    xlab("State") +
                    theme(text = element_text(size = 12),
                          axis.text.x = element_text(angle = 70))

plotly::ggplotly(rate_comparison, width = 700) %>%
  plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_output,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::


#### Fuel types

::: panel-tabset

##### Coal output rate

```{r}
#| label: coal-output-rate-state

coal_output <- 
  state_rate_comparison %>% select(state, contains("coal_output_rate"))

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = coal_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Coal output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(coal_output,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Oil output rate

```{r}
#| label: oil-output-rate-state

oil_output <- 
  state_rate_comparison %>% select(state, contains("oil_output_rate"))

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = oil_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Oil output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(oil_output,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Gas output rate

```{r}
#| label: gas-output-rate-state

gas_output <- 
  state_rate_comparison %>% select(state, contains("gas_output_rate"))

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = gas_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Gas output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(gas_output,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Fossil fuel output rate

```{r}
#| label: fossil-output-rate-state

fossil_output <- 
  state_rate_comparison %>% select(state, contains("fossil_output_rate"))

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = fossil_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Fossil fuel output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(fossil_output,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```
:::

##### NOx fuel types

::: panel-tabset
###### NOx coal output rate

```{r}
#| label: nox-output-rate-coal-state

nox_output_coal <- 
  state_rate_comparison %>% 
  select(state, contains("nox_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx coal output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### NOx oil output rate

```{r}
#| label: nox-output-rate-oil-state

nox_output_oil <- 
  state_rate_comparison %>% 
  select(state, contains("nox_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx oil output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx gas output rate

```{r}
#| label: nox-output-rate-gas-state

nox_output_gas <- 
  state_rate_comparison %>% 
  select(state, contains("nox_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx gas output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx fossil fuel output rate

```{r}
#| label: nox-output-rate-fossil-state

nox_output_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("nox_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx fossil fuel output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### NOx ozone fuel types

::: panel-tabset
###### NOx ozone coal output rate

```{r}
#| label: nox-oz-output-rate-coal-state

nox_oz_output_coal <- 
  state_rate_comparison %>% 
  select(state, contains("nox_oz_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx coal output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### NOx oil output rate

```{r}
#| label: nox-oz-output-rate-oil-state

nox_oz_output_oil <- 
  state_rate_comparison %>% 
  select(state, contains("nox_oz_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx oil output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx gas output rate

```{r}
#| label: nox-oz-output-rate-gas-state

nox_oz_output_gas <- 
  state_rate_comparison %>% 
  select(state, contains("nox_oz_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx gas output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx fossil fuel output rate

```{r}
#| label: nox-oz-output-rate-fossil-state

nox_oz_output_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("nox_oz_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx fossil fuel output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### SO2 fuel types

::: panel-tabset
###### SO2 coal output rate

```{r}
#| label: so2-output-rate-coal-state

so2_output_coal <- 
  state_rate_comparison %>% 
  select(state, contains("so2_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 coal output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### SO2 oil output rate

```{r}
#| label: so2-output-rate-oil-state

so2_output_oil <- 
  state_rate_comparison %>% 
  select(state, contains("so2_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 oil output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### SO2 gas output rate

```{r}
#| label: so2-output-rate-gas-state

so2_output_gas <- 
  state_rate_comparison %>% 
  select(state, contains("so2_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 gas output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### SO2 fossil fuel output rate

```{r}
#| label: so2-output-rate-fossil-state

so2_output_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("so2_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 fossil fuel output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CO2 fuel types

::: panel-tabset
###### CO2 coal output rate

```{r}
#| label: co2-output-rate-coal-state

co2_output_coal <- 
  state_rate_comparison %>% 
  select(state, contains("co2_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 coal output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CO2 oil output rate

```{r}
#| label: co2-output-rate-oil-state

co2_output_oil <- 
  state_rate_comparison %>% 
  select(state, contains("co2_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 oil output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2 gas output rate

```{r}
#| label: co2-output-rate-gas-state

co2_output_gas <- 
  state_rate_comparison %>% 
  select(state, contains("co2_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 gas output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2 fossil fuel output rate

```{r}
#| label: co2-output-rate-fossil-state

co2_output_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("co2_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 fossil fuel output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CH4 fuel types

::: panel-tabset
###### CH4 coal output rate

```{r}
#| label: ch4-output-rate-coal-state

ch4_output_coal <- 
  state_rate_comparison %>% 
  select(state, contains("ch4_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 coal output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CH4 oil output rate

```{r}
#| label: ch4-output-rate-oil-state

ch4_output_oil <- 
  state_rate_comparison %>% 
  select(state, contains("ch4_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 oil output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CH4 gas output rate

```{r}
#| label: ch4-output-rate-gas-state

ch4_output_gas <- 
  state_rate_comparison %>% 
  select(state, contains("ch4_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 gas output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CH4 fossil fuel output rate

```{r}
#| label: ch4-output-rate-fossil-state

ch4_output_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("ch4_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 fossil fuel output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### N2O fuel types

::: panel-tabset
###### N2O coal output rate

```{r}
#| label: n2o-output-rate-coal-state

n2o_output_coal <- 
  state_rate_comparison %>% 
  select(state, contains("n2o_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O coal output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### N2O oil output rate

```{r}
#| label: n2o-output-rate-oil-state

n2o_output_oil <- 
  state_rate_comparison %>% 
  select(state, contains("n2o_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O oil output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### N2O gas output rate

```{r}
#| label: n2o-output-rate-gas-state

n2o_output_gas <- 
  state_rate_comparison %>% 
  select(state, contains("n2o_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O gas output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### N2O fossil fuel output rate

```{r}
#| label: n2o-output-rate-fossil-state

n2o_output_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("n2o_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O fossil fuel output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CO2e fuel types

::: panel-tabset
###### CO2e coal output rate

```{r}
#| label: co2e-output-rate-coal-state

co2e_output_coal <- 
  state_rate_comparison %>% 
  select(state, contains("co2e_output_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_output_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e coal output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_output_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CO2e oil output rate

```{r}
#| label: co2e-output-rate-oil-state

co2e_output_oil <- 
  state_rate_comparison %>% 
  select(state, contains("co2e_output_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_output_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e oil output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_output_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2e gas output rate

```{r}
#| label: co2e-output-rate-gas-state

co2e_output_gas <- 
  state_rate_comparison %>% 
  select(state, contains("co2e_output_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_output_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e gas output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_output_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2e fossil fuel output rate

```{r}
#| label: co2e-output-rate-fossil-state

co2e_output_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("co2e_output_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_output_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e fossil fuel output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_output_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

### Input emission rate comparison

#### Emission type

::: panel-tabset
##### NOx input rate

```{r}
#| label: nox-input-rate-state

nox_input <- 
  state_rate_comparison %>% select(state, contains("nox_input_rate_2"),
                                   nox_input_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_input_rate,
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### NOx ozone input rate

```{r}
#| label: nox-input-oz-rate-state

nox_oz_input <- 
  state_rate_comparison %>% select(state, contains("nox_oz_input_rate_2"),
                                   nox_oz_input_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### SO2 input rate

```{r}
#| label: so2-input-rate-state

so2_input <- 
  state_rate_comparison %>% select(state, contains("so2_input_rate_2"),
                                   so2_input_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### CO2 input rate

```{r}
#| label: co2-input-rate-state

co2_input <- 
  state_rate_comparison %>% select(state, contains("co2_input_rate_2"),
                                   co2_input_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state,
                                                y = co2_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_input,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### CH4 input rate

```{r}
#| label: ch4-input-rate-state

ch4_output <- 
  state_rate_comparison %>% select(state, contains("ch4_output_rate_2"),
                                   ch4_input_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### N2O input rate

```{r}
#| label: n2o-input-rate-state

n2o_input <- 
  state_rate_comparison %>% select(state, contains("n2o_input_rate_2"),
                                   n2o_input_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

##### CO2e input rate

```{r}
#| label: co2e-input-rate-state

co2e_input <- 
  state_rate_comparison %>% select(state, contains("co2e_input_rate_2"),
                                   co2e_input_rate_pct, generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_input,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::


#### Fuel types

::: panel-tabset

##### Coal input rate

```{r}
#| label: coal-input-rate-state

coal_input <- 
  state_rate_comparison %>% select(state, contains("coal_input_rate"))

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = coal_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Coal input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(coal_input,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Oil input rate

```{r}
#| label: oil-input-rate-state

oil_input <- 
  state_rate_comparison %>% select(state, contains("oil_input_rate"))

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = oil_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Oil input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(oil_input,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Gas input rate

```{r}
#| label: gas-input-rate-state

gas_input <- 
  state_rate_comparison %>% select(state, contains("gas_input_rate"))

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = gas_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Gas input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(gas_input,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```

##### Fossil fuel rate

```{r}
#| label: fossil-input-rate-state

fossil_input <- 
  state_rate_comparison %>% select(state, contains("fossil_input_rate"))

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = fossil_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("Fossil fuel input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(fossil_input,
             digits = c(0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change")) 
```
:::
##### NOx fuel types

::: panel-tabset
###### NOx coal input rate

```{r}
#| label: nox-input-rate-coal-state

nox_input_coal <- 
  state_rate_comparison %>% 
  select(state, contains("nox_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx coal input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### NOx oil input rate

```{r}
#| label: nox-input-rate-oil-state

nox_input_oil <- 
  state_rate_comparison %>% 
  select(state, contains("nox_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx oil input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx gas input rate

```{r}
#| label: nox-input-rate-gas-state

nox_input_gas <- 
  state_rate_comparison %>% 
  select(state, contains("nox_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx gas input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx fossil fuel input rate

```{r}
#| label: nox-input-rate-fossil-state

nox_input_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("nox_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx fossil fuel input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### NOx ozone fuel types

::: panel-tabset
###### NOx ozone coal input rate

```{r}
#| label: nox-oz-input-rate-coal-state

nox_oz_input_coal <- 
  state_rate_comparison %>% 
  select(state, contains("nox_oz_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx coal input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### NOx oil input rate

```{r}
#| label: nox-oz-input-rate-oil-state

nox_oz_input_oil <- 
  state_rate_comparison %>% 
  select(state, contains("nox_oz_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx oil input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx gas input rate

```{r}
#| label: nox-oz-input-rate-gas-state

nox_oz_input_gas <- 
  state_rate_comparison %>% 
  select(state, contains("nox_oz_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx gas input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### NOx fossil fuel input rate

```{r}
#| label: nox-oz-input-rate-fossil-state

nox_oz_input_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("nox_oz_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx fossil fuel input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### SO2 fuel types

::: panel-tabset
###### SO2 coal input rate

```{r}
#| label: so2-input-rate-coal-state

so2_input_coal <- 
  state_rate_comparison %>% 
  select(state, contains("so2_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 coal input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### SO2 oil input rate

```{r}
#| label: so2-input-rate-oil-state

so2_input_oil <- 
  state_rate_comparison %>% 
  select(state, contains("so2_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 oil input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### SO2 gas input rate

```{r}
#| label: so2-input-rate-gas-state

so2_input_gas <- 
  state_rate_comparison %>% 
  select(state, contains("so2_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 gas input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### SO2 fossil fuel input rate

```{r}
#| label: so2-input-rate-fossil-state

so2_input_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("so2_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 fossil fuel input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CO2 fuel types

::: panel-tabset
###### CO2 coal input rate

```{r}
#| label: co2-input-rate-coal-state

co2_input_coal <- 
  state_rate_comparison %>% 
  select(state, contains("co2_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 coal input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CO2 oil input rate

```{r}
#| label: co2-input-rate-oil-state

co2_input_oil <- 
  state_rate_comparison %>% 
  select(state, contains("co2_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 oil input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2 gas input rate

```{r}
#| label: co2-input-rate-gas-state

co2_input_gas <- 
  state_rate_comparison %>% 
  select(state, contains("co2_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 gas input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2 fossil fuel input rate

```{r}
#| label: co2-input-rate-fossil-state

co2_input_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("co2_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 fossil fuel input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CH4 fuel types

::: panel-tabset
###### CH4 coal input rate

```{r}
#| label: ch4-input-rate-coal-state

ch4_input_coal <- 
  state_rate_comparison %>% 
  select(state, contains("ch4_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 coal input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CH4 oil input rate

```{r}
#| label: ch4-input-rate-oil-state

ch4_input_oil <- 
  state_rate_comparison %>% 
  select(state, contains("ch4_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 oil input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CH4 gas input rate

```{r}
#| label: ch4-input-rate-gas-state

ch4_input_gas <- 
  state_rate_comparison %>% 
  select(state, contains("ch4_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 gas input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CH4 fossil fuel input rate

```{r}
#| label: ch4-input-rate-fossil-state

ch4_input_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("ch4_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 fossil fuel input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### N2O fuel types

::: panel-tabset
###### N2O coal input rate

```{r}
#| label: n2o-input-rate-coal-state

n2o_input_coal <- 
  state_rate_comparison %>% 
  select(state, contains("n2o_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O coal input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### N2O oil input rate

```{r}
#| label: n2o-input-rate-oil-state

n2o_input_oil <- 
  state_rate_comparison %>% 
  select(state, contains("n2o_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O oil input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### N2O gas input rate

```{r}
#| label: n2o-input-rate-gas-state

n2o_input_gas <- 
  state_rate_comparison %>% 
  select(state, contains("n2o_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O gas input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### N2O fossil fuel input rate

```{r}
#| label: n2o-input-rate-fossil-state

n2o_input_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("n2o_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O fossil fuel input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

##### CO2e fuel types

::: panel-tabset
###### CO2e coal input rate

```{r}
#| label: co2e-input-rate-coal-state

co2e_input_coal <- 
  state_rate_comparison %>% 
  select(state, contains("co2e_input_rate_coal"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_input_rate_coal, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e coal input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_input_coal,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

###### CO2e oil input rate

```{r}
#| label: co2e-input-rate-oil-state

co2e_input_oil <- 
  state_rate_comparison %>% 
  select(state, contains("co2e_input_rate_oil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_input_rate_oil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e oil input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_input_oil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2e gas input rate

```{r}
#| label: co2e-input-rate-gas-state

co2e_input_gas <- 
  state_rate_comparison %>% 
  select(state, contains("co2e_input_rate_gas"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_input_rate_gas, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e gas input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_input_gas,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```

###### CO2e fossil fuel input rate

```{r}
#| label: co2e-input-rate-fossil-state

co2e_input_fossil <- 
  state_rate_comparison %>% 
  select(state, contains("co2e_input_rate_fossil"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_input_rate_fossil, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e fossil fuel input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_input_fossil,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes"))
```
:::

### Combustion output emission rate comparison

::: panel-tabset
#### NOx combustion output rate

```{r}
#| label: nox-combustion-rate-state

nox_combustion <- 
  state_rate_comparison %>% select(state, contains("nox_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### NOx ozone combustion output rate

```{r}
#| label: nox-oz-combustion-rate-state

nox_oz_combustion <- 
  state_rate_comparison %>% select(state, contains("nox_oz_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state,
                                                y = nox_oz_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### SO2 combustion output rate

```{r}
#| label: so2-combustion-rate-state

so2_combustion <- 
  state_rate_comparison %>% select(state, contains("so2_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2 combustion output rate

```{r}
#| label: co2-combustion-rate-state

co2_combustion <- 
  state_rate_comparison %>% select(state, contains("co2_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_combustion,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CH4 combustion output rate

```{r}
#| label: ch4-combustion-rate-state

ch4_combustion <- 
  state_rate_comparison %>% select(state, contains("ch4_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### N2O combustion output rate

```{r}
#| label: n2o-combustion-rate-state

n2o_combustion <- 
  state_rate_comparison %>% select(state, contains("n2o_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2e combustion output rate

```{r}
#| label: co2e-combustion-rate-state

co2e_combustion <- 
  state_rate_comparison %>% select(state, contains("co2e_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_combustion,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

### Nonbaseload output emission rate comparison

::: panel-tabset
#### NOx nonbaseload output rate

```{r}
#| label: nox-nonbaseload-rate-state

nox_nonbaseload <- 
  state_rate_comparison %>% select(state, contains("nox_nonbaseload"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx nonbaseload output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_nonbaseload,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### NOx ozone nonbaseload output rate

```{r}
#| label: nox-oz-nonbaseload-rate-state

nox_oz_nonbaseload <- 
  state_rate_comparison %>% select(state, contains("nox_oz_nonbaseload"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state,
                                                y = nox_oz_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone nonbaseload output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(nox_oz_nonbaseload,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### SO2 nonbaseload output rate

```{r}
#| label: so2-nonbaseload-rate-state

so2_nonbaseload <- 
  state_rate_comparison %>% select(state, contains("so2_nonbaseload"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 nonbaseload output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(so2_nonbaseload,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2 nonbaseload output rate

```{r}
#| label: co2-nonbaseload-rate-state

co2_nonbaseload <- 
  state_rate_comparison %>% select(state, contains("co2_nonbaseload"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 nonbaseload output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2_nonbaseload,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CH4 nonbaseload output rate

```{r}
#| label: ch4-nonbaseload-rate-state

ch4_nonbaseload <- 
  state_rate_comparison %>% select(state, contains("ch4_nonbaseload"), 
                                   generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 nonbaseload output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(ch4_nonbaseload,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### N2O nonbaseload output rate

```{r}
#| label: n2o-nonbaseload-rate-state

n2o_nonbaseload <- 
  state_rate_comparison %>% select(state, contains("n2o_nonbaseload"), 
                                   generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O nonbaseload output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(n2o_nonbaseload,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2e nonbaseload output rate

```{r}
#| label: co2e-nonbaseload-rate-state

co2e_nonbaseload <- 
  state_rate_comparison %>% select(state, contains("co2e_nonbaseload"), 
                                   generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_nonbaseload_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e nonbaseload output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison, width = 700) %>% 
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))

knitr::kable(co2e_nonbaseload,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

-   include fuel-specific input emission rates and output emission rates for both subgregion and state level

# Resource mix comparison

## US resource mix

::: panel-tabset
### US resource mix table

```{r}
#| label: US-resource-mix-table 
 
knitr::kable(us_resource_mix_formatted,
             digits = 2, 
             format.args = list(big.mark = ","), 
             col.names = gsub("[_]", " ", names(us_resource_mix_formatted))) %>%
  row_spec(1, background = "#ffefd5") %>% 
  column_spec(6,
              background = case_when(us_resource_mix_formatted$percent_change 
                                     > 0 ~ "#e9ffdb", 
                                     us_resource_mix_formatted$percent_change 
                                     == 0 ~ "#dcdcdc", 
                                     us_resource_mix_formatted$percent_change 
                                     < 0 ~ "#f7bfbe"), 
              color = case_when(us_resource_mix_formatted$percent_change 
                                > 0 ~ "#013220", 
                                us_resource_mix_formatted$percent_change 
                                == 0 ~ "#000000", 
                                us_resource_mix_formatted$percent_change 
                                < 0 ~ "#860111"))  
  
```

### US resource mix figure

```{r}
#| label: US-resource-mix-figure
 

resource_comparison <-    
  ggplot(us_resource_mix, 
         aes(x = energy_source_generation / 1000,               
           y = reorder(energy_source, energy_source_generation), fill = year)) +
  geom_bar(stat = "identity",
           width = 0.75,
           position = "dodge") +   
  xlab("Generation (GWh)") +    
  ylab("Energy source") +    
  theme(text = element_text(size = 12))     

plotly::ggplotly(resource_comparison) %>%
plotly::layout(legend = list(orientation = "h", x = 0.2, y = 1.1))  
```
:::

## Subregion resource mix

::: panel-tabset
### AKGD

```{r}
#| label: AKGD-summary

source("scripts/functions/function_region_summary.R")

create_resource_plot_subregion("AKGD", c(prev_yr1, cur_year))
create_cap_table_subregion("AKGD", c(prev_yr1, cur_year))
create_resource_table_subregion("AKGD", c(prev_yr1, cur_year))
```

### AKMS

```{r}
#| label: AKMS-summary

create_resource_plot_subregion("AKMS", c(prev_yr1, cur_year))
create_cap_table_subregion("AKMS", c(prev_yr1, cur_year))
create_resource_table_subregion("AKMS", c(prev_yr1, cur_year))
```

### AZNM

```{r}
#| label: AZNM-summary

create_resource_plot_subregion("AKMS", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("AZNM", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("AZNM", 
                            c(prev_yr1, cur_year))
```

### CAMX

```{r}
#| label: CAMX-summary

create_resource_plot_subregion("CAMX", c(prev_yr1, cur_year))
create_cap_table_subregion("CAMX", c(prev_yr1, cur_year))
create_resource_table_subregion("CAMX", c(prev_yr1, cur_year))
```

### ERCT

```{r}
#| label: ERCT-summary

create_resource_plot_subregion("ERCT", c(prev_yr1, cur_year))
create_cap_table_subregion("ERCT", c(prev_yr1, cur_year))
create_resource_table_subregion("ERCT", c(prev_yr1, cur_year))
```

### FRCC

```{r}
#| label: FRCC-summary

create_resource_plot_subregion("FRCC", c(prev_yr1, cur_year))
create_cap_table_subregion("FRCC", c(prev_yr1, cur_year))
create_resource_table_subregion("FRCC", c(prev_yr1, cur_year))
```

### HIMS

```{r}
#| label: HIMS-summary

create_resource_plot_subregion("HIMS", c(prev_yr1, cur_year))
create_cap_table_subregion("HIMS", c(prev_yr1, cur_year))
create_resource_table_subregion("HIMS", c(prev_yr1, cur_year))
```

### HIOA

```{r}
#| label: HIOA-summary

create_resource_plot_subregion("HIOA", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("HIOA", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("HIOA", 
                            c(prev_yr1, cur_year))
```

### MROE

```{r}
#| label: MROE-summary

create_resource_plot_subregion("MROE", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("MROE", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("MROE", 
                            c(prev_yr1, cur_year))
```

### MROW

```{r}
#| label: MROW-summary

create_resource_plot_subregion("MROW", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("MROW", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("MROW", 
                            c(prev_yr1, cur_year))
```

### NEWE

```{r}
#| label: NEWE-summary

create_resource_plot_subregion("NEWE", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("NEWE", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("NEWE", 
                            c(prev_yr1, cur_year))
```

### NWPP

```{r}
#| label: NWPP-summary

create_resource_plot_subregion("NWPP", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("NWPP", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("NWPP", 
                            c(prev_yr1, cur_year))
```

### NYCW

```{r}
#| label: NYCW-summary

create_resource_plot_subregion("NYCW", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("NYCW", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("NYCW", 
                            c(prev_yr1, cur_year))
```

### NYLI

```{r}
#| label: NYLI-summary

create_resource_plot_subregion("NYLI", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("NYLI",
                       c(prev_yr1, cur_year))
create_resource_table_subregion("NYLI", 
                            c(prev_yr1, cur_year))
```

### NYUP

```{r}
#| label: NYUP-summary

create_resource_plot_subregion("NYUP", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("NYUP", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("NYUP", 
                            c(prev_yr1, cur_year))
```

### PRMS

```{r}
#| label: PRMS-summary

create_resource_plot_subregion("PRMS", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("PRMS", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("PRMS", 
                            c(prev_yr1, cur_year))
```

### RFCE

```{r}
#| label: RFCE-summary

create_resource_plot_subregion("RFCE", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("RFCE", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("RFCE", 
                            c(prev_yr1, cur_year))
```

### RFCM

```{r}
#| label: RFCM-summary

create_resource_plot_subregion("RFCM", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("RFCM", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("RFCM", 
                            c(prev_yr1, cur_year))
```

### RFCW

```{r}
#| label: RFCW-summary

create_resource_plot_subregion("RFCW", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("RFCW", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("RFCW", 
                            c(prev_yr1, cur_year))
```

### RMPA

```{r}
#| label: RMPA-summary

create_resource_plot_subregion("RMPA", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("RMPA", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("RMPA", 
                            c(prev_yr1, cur_year))
```

### SPNO

```{r}
#| label: SPNO-summary

create_resource_plot_subregion("SPNO", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("SPNO", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SPNO", 
                            c(prev_yr1, cur_year))
```

### SPSO

```{r}
#| label: SPSO-summary

create_resource_plot_subregion("SPSO", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("SPSO", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SPSO", 
                            c(prev_yr1, cur_year))
```

### SRMV

```{r}
#| label: SRMV-summary

create_resource_plot_subregion("SRMV", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("SRMV", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SRMV", 
                            c(prev_yr1, cur_year))
```

### SRSO

```{r}
#| label: SRSO-summary

create_resource_plot_subregion("SRSO", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("SRSO", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SRSO", 
                            c(prev_yr1, cur_year))
```

### SRTV

```{r}
#| label: SRTV-summary

create_resource_plot_subregion("SRTV", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("SRTV", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SRTV", 
                            c(prev_yr1, cur_year))
```

### SRVC

```{r}
#| label: SRVC-summary

create_resource_plot_subregion("SRVC", 
                           c(prev_yr1, cur_year))
create_cap_table_subregion("SRVC", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SRVC", 
                            c(prev_yr1, cur_year))
```
:::

## State resource mix

::: panel-tabset
### AK

```{r}
#| label: AK-summary

create_resource_plot_state("AK", 
                           c(prev_yr1, cur_year))
create_cap_table_state("AK", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AK", 
                            c(prev_yr1, cur_year))
```

### AL

```{r}
#| label: AL_summary

create_resource_plot_state("AL", 
                           c(prev_yr1, cur_year))
create_cap_table_state("AL", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AL", 
                            c(prev_yr1, cur_year))
```

### AR

```{r}
#| label: AR-summary

create_resource_plot_state("AR", 
                           c(prev_yr1, cur_year))
create_cap_table_state("AR", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AR", 
                            c(prev_yr1, cur_year))
```

### AZ

```{r}
#| label: AZ-summary

create_resource_plot_state("AZ", 
                           c(prev_yr1, cur_year))
create_cap_table_state("AZ", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AZ", 
                            c(prev_yr1, cur_year))
```

### CA

```{r}
#| label: CA-summary

create_resource_plot_state("CA", 
                           c(prev_yr1, cur_year))
create_cap_table_state("CA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("CA", 
                            c(prev_yr1, cur_year))
```

### CO

```{r}
#| label: CO-summary

create_resource_plot_state("CO", 
                           c(prev_yr1, cur_year))
create_cap_table_state("CO", 
                       c(prev_yr1, cur_year))
create_resource_table_state("CO", 
                            c(prev_yr1, cur_year))
```

### CT

```{r}
#| label: CT-summary

create_resource_plot_state("CT", 
                           c(prev_yr1, cur_year))
create_cap_table_state("CT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("CT", 
                            c(prev_yr1, cur_year))
```

### DC

```{r}
#| label: DC-summary

create_resource_plot_state("DC", 
                           c(prev_yr1, cur_year))
create_cap_table_state("DC", 
                       c(prev_yr1, cur_year))
create_resource_table_state("DC", 
                            c(prev_yr1, cur_year))
```

### DE

```{r}
#| label: DE-summary

create_resource_plot_state("DE", 
                           c(prev_yr1, cur_year))
create_cap_table_state("DE", 
                       c(prev_yr1, cur_year))
create_resource_table_state("DE", 
                            c(prev_yr1, cur_year))
```

### FL

```{r}
#| label: FL-summary

create_resource_plot_state("FL", 
                           c(prev_yr1, cur_year))
create_cap_table_state("FL", 
                       c(prev_yr1, cur_year))
create_resource_table_state("FL", 
                            c(prev_yr1, cur_year))
```

### GA

```{r}
#| label: GA-summary

create_resource_plot_state("GA", 
                           c(prev_yr1, cur_year))
create_cap_table_state("GA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("GA", 
                            c(prev_yr1, cur_year))
```

### HI

```{r}
#| label: HI-summary

create_resource_plot_state("HI", 
                           c(prev_yr1, cur_year))
create_cap_table_state("HI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("HI", 
                            c(prev_yr1, cur_year))
```

### IA

```{r}
#| label: IA-summary

create_resource_plot_state("IA", 
                           c(prev_yr1, cur_year))
create_cap_table_state("IA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("IA", 
                            c(prev_yr1, cur_year))
```

### ID

```{r}
#| label: ID-summary

create_resource_plot_state("ID", 
                           c(prev_yr1, cur_year))
create_cap_table_state("ID", 
                       c(prev_yr1, cur_year))
create_resource_table_state("ID", 
                            c(prev_yr1, cur_year))
```

### IL

```{r}
#| label: IL-summary

create_resource_plot_state("IL", 
                           c(prev_yr1, cur_year))
create_cap_table_state("IL", 
                       c(prev_yr1, cur_year))
create_resource_table_state("IL", 
                            c(prev_yr1, cur_year))
```

### IN

```{r}
#| label: IN-summary

create_resource_plot_state("IN", 
                           c(prev_yr1, cur_year))
create_cap_table_state("IN", 
                       c(prev_yr1, cur_year))
create_resource_table_state("IN", 
                            c(prev_yr1, cur_year))
```

### KS

```{r}
#| label: KS-summary

create_resource_plot_state("KS", 
                           c(prev_yr1, cur_year))
create_cap_table_state("KS", 
                       c(prev_yr1, cur_year))
create_resource_table_state("KS", 
                            c(prev_yr1, cur_year))
```

### KY

```{r}
#| label: KY-summary

create_resource_plot_state("KY", 
                           c(prev_yr1, cur_year))
create_cap_table_state("KY", 
                       c(prev_yr1, cur_year))
create_resource_table_state("KY", 
                            c(prev_yr1, cur_year))
```

### LA

```{r}
#| label: LA-summary

create_resource_plot_state("LA", 
                           c(prev_yr1, cur_year))
create_cap_table_state("LA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("LA", 
                            c(prev_yr1, cur_year))
```

### MA

```{r}
#| label: MA-summary

create_resource_plot_state("MA", 
                           c(prev_yr1, cur_year))
create_cap_table_state("MA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MA", 
                            c(prev_yr1, cur_year))
```

### MD

```{r}
#| label: MD-summary

create_resource_plot_state("MD", 
                           c(prev_yr1, cur_year))
create_cap_table_state("MD", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MD", 
                            c(prev_yr1, cur_year))
```

### ME

```{r}
#| label: ME-summary

create_resource_plot_state("ME", 
                           c(prev_yr1, cur_year))
create_cap_table_state("ME", 
                       c(prev_yr1, cur_year))
create_resource_table_state("ME", 
                            c(prev_yr1, cur_year))
```

### MI

```{r}
#| label: MI-summary

create_resource_plot_state("MI", 
                           c(prev_yr1, cur_year))
create_cap_table_state("MI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MI", 
                            c(prev_yr1, cur_year))
```

### MN

```{r}
#| label: MN-summary

create_resource_plot_state("MN", 
                           c(prev_yr1, cur_year))
create_cap_table_state("MN", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MN", 
                            c(prev_yr1, cur_year))
```

### MO

```{r}
#| label: MO-summary

create_resource_plot_state("MO", 
                           c(prev_yr1, cur_year))
create_cap_table_state("MO", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MO", 
                            c(prev_yr1, cur_year))
```

### MS

```{r}
#| label: MS-summary

create_resource_plot_state("MS", 
                           c(prev_yr1, cur_year))
create_cap_table_state("MS", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MS", 
                            c(prev_yr1, cur_year))
```

### MT

```{r}
#| label: MT-summary

create_resource_plot_state("MT", 
                           c(prev_yr1, cur_year))
create_cap_table_state("MT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MT", 
                            c(prev_yr1, cur_year))
```

### NC

```{r}
#| label: NC-summary

create_resource_plot_state("NC", 
                           c(prev_yr1, cur_year))
create_cap_table_state("NC", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NC", 
                            c(prev_yr1, cur_year))
```

### ND

```{r}
#| label: ND-summary

create_resource_plot_state("ND", 
                           c(prev_yr1, cur_year))
create_cap_table_state("ND", 
                       c(prev_yr1, cur_year))
create_resource_table_state("ND", 
                            c(prev_yr1, cur_year))
```

### NE

```{r}
#| label: NE-summary

create_resource_plot_state("NE", 
                           c(prev_yr1, cur_year))
create_cap_table_state("NE", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NE", 
                            c(prev_yr1, cur_year))
```

### NH

```{r}
#| label: NH-summary

create_resource_plot_state("NH", 
                           c(prev_yr1, cur_year))
create_cap_table_state("NH", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NH", 
                            c(prev_yr1, cur_year))
```

### NJ

```{r}
#| label: NJ-summary

create_resource_plot_state("NJ", 
                           c(prev_yr1, cur_year))
create_cap_table_state("NJ", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NJ", 
                            c(prev_yr1, cur_year))
```

### NM

```{r}
#| label: NM-summary

create_resource_plot_state("NM", 
                           c(prev_yr1, cur_year))
create_cap_table_state("NM", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NM", 
                            c(prev_yr1, cur_year))
```

### NV

```{r}
#| label: NV-summary

create_resource_plot_state("NV",
                           c(prev_yr1, cur_year))
create_cap_table_state("NV", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NV", 
                            c(prev_yr1, cur_year))
```

### NY

```{r}
#| label: NY-summary

create_resource_plot_state("NY", 
                           c(prev_yr1, cur_year))
create_cap_table_state("NY", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NY", 
                            c(prev_yr1, cur_year))
```

### OH

```{r}
#| label: OH-summary

create_resource_plot_state("OH", c(prev_yr1, cur_year))
create_cap_table_state("OH", c(prev_yr1, cur_year))
create_resource_table_state("OH", c(prev_yr1, cur_year))
```

### OK

```{r}
#| label: OK-summary

create_resource_plot_state("OK", 
                           c(prev_yr1, cur_year))
create_cap_table_state("OK", 
                       c(prev_yr1, cur_year))
create_resource_table_state("OK", 
                            c(prev_yr1, cur_year))
```

### OR

```{r}
#| label: OR-summary

create_resource_plot_state("OR", 
                           c(prev_yr1, cur_year))
create_cap_table_state("OR", 
                       c(prev_yr1, cur_year))
create_resource_table_state("OR", 
                            c(prev_yr1, cur_year))
```

### PA

```{r}
#| label: PA-summary

create_resource_plot_state("PA", 
                           c(prev_yr1, cur_year))
create_cap_table_state("PA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("PA", 
                            c(prev_yr1, cur_year))
```

### PR

```{r}
#| label: PR-summary

create_resource_plot_state("PR", 
                           c(prev_yr1, cur_year))
create_cap_table_state("PR", 
                       c(prev_yr1, cur_year))
create_resource_table_state("PR", 
                            c(prev_yr1, cur_year))
```

### RI

```{r}
#| label: RI-summary

create_resource_plot_state("RI", 
                           c(prev_yr1, cur_year))
create_cap_table_state("RI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("RI", 
                            c(prev_yr1, cur_year))
```

### SC

```{r}
#| label: SC-summary

create_resource_plot_state("SC", 
                           c(prev_yr1, cur_year))
create_cap_table_state("SC", 
                       c(prev_yr1, cur_year))
create_resource_table_state("SC", 
                            c(prev_yr1, cur_year))
```

### SD

```{r}
#| label: SD-summary

create_resource_plot_state("SD", 
                           c(prev_yr1, cur_year))
create_cap_table_state("SD", 
                       c(prev_yr1, cur_year))
create_resource_table_state("SD", 
                            c(prev_yr1, cur_year))
```

### TN

```{r}
#| label: TN-summary

create_resource_plot_state("TN", 
                           c(prev_yr1, cur_year))
create_cap_table_state("TN", 
                       c(prev_yr1, cur_year))
create_resource_table_state("TN", 
                            c(prev_yr1, cur_year))
```

### TX

```{r}
#| label: TX-summary

create_resource_plot_state("TX", 
                           c(prev_yr1, cur_year))
create_cap_table_state("TX", 
                       c(prev_yr1, cur_year))
create_resource_table_state("TX", 
                            c(prev_yr1, cur_year))
```

### UT

```{r}
#| label: UT-summary

create_resource_plot_state("UT", c(prev_yr1, cur_year))
create_cap_table_state("UT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("UT", c(prev_yr1, cur_year))
```

### VA

```{r}
#| label: VA-summary

create_resource_plot_state("VA", 
                           c(prev_yr1, cur_year))
create_cap_table_state("VA", c(prev_yr1, cur_year))
create_resource_table_state("VA", 
                            c(prev_yr1, cur_year))
```

### VT

```{r}
#| label: VT-summary

create_resource_plot_state("VT", 
                           c(prev_yr1, cur_year))
create_cap_table_state("VT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("VT", 
                            c(prev_yr1, cur_year))
```

### WA

```{r}
#| label: WA-summary

create_resource_plot_state("WA", 
                           c(prev_yr1, cur_year))
create_cap_table_state("WA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WA", 
                            c(prev_yr1, cur_year))
```

### WI

```{r}
#| label: WI-summary

create_resource_plot_state("WI", 
                           c(prev_yr1, cur_year))
create_cap_table_state("WI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WI", 
                            c(prev_yr1, cur_year))
```

### WV

```{r}
#| label: WV-summary

create_resource_plot_state("WV", 
                           c(prev_yr1, cur_year))
create_cap_table_state("WV", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WV", 
                            c(prev_yr1, cur_year))
```

### WY

```{r}
#| label: WY-summary

create_resource_plot_state("WY", 
                           c(prev_yr1, cur_year))
create_cap_table_state("WY", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WY", 
                            c(prev_yr1, cur_year))
```
:::

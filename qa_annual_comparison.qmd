---
title: "QA Annual Comparison"
format: 
  html: 
    toc: true
    toc-expand: true
    toc-location: left
execute: 
  echo: false
  warning: false
editor: visual
params: 
  eGRID_year: 2023
  year_abbrev: 23
---

```{r}
#| label: set-up-file

library(ggplot2)
library(dplyr)
library(kableExtra)
```

This file compares the final output of eGRID to previous year outputs.

```{r}
#| label: read-qa-file
#| file: "scripts/qa/annual_qa/qa_egrid_annual_comparison.R"


#| results: False
```

# Rate comparison

## Subregion

Compare subregion emission rates from `r prev_yr3` to `r params$eGRID_year` and percent change from `r prev_yr1` to `r params$eGRID_year`.

### Output emission rate comparison

::: panel-tabset
#### NOx output rate

```{r}
#| label: nox-output-rate-subregion

nox_output <- 
  subregion_rate_comparison %>% 
  select(subregion, contains("nox_output"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### NOx ozone output rate

```{r}
#| label: nox-oz-output-rate-subregion

nox_oz_output <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_oz_output"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_oz_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### SO2 output rate

```{r}
#| label: so2-output-rate-subregion

so2_output <- 
  subregion_rate_comparison %>% select(subregion, contains("so2_output"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(so2_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent Change",
                           "Notes")) 
```

#### CO2 output rate

```{r}
#| label: co2-output-rate-subregion

co2_output <- 
  subregion_rate_comparison %>% select(subregion, contains("co2_output"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2_output,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CH4 output rate

```{r}
#| label: ch4-output-rate-subregion

ch4_output <- 
  subregion_rate_comparison %>% select(subregion, contains("ch4_output"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion,
                                                y = ch4_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(ch4_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### N2O output rate

```{r}
#| label: n2o-output-rate-subregion

n2o_output <- 
  subregion_rate_comparison %>% select(subregion, contains("n2o_output"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion,
                                                y = n2o_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(n2o_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2e output rate

```{r}
#| label: co2e-output-rate-subregion

co2e_output <- 
  subregion_rate_comparison %>% select(subregion, contains("co2e_output"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2e_output,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

### Input emission rate comparison

::: panel-tabset
#### NOx input rate

```{r}
#| label: nox-input-rate-subregion

nox_input <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_input"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_input_rate,
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### NOx ozone input rate

```{r}
#| label: nox-input-oz-rate-subregion

nox_oz_input <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_oz_input"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_oz_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_oz_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### SO2 input rate

```{r}
#| label: so2-input-rate-subregion

so2_input <- 
  subregion_rate_comparison %>% select(subregion, contains("so2_input"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(so2_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2 input rate

```{r}
#| label: co2-input-rate-subregion

co2_input <- 
  subregion_rate_comparison %>% select(subregion, contains("co2_input"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion,
                                                y = co2_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2_input,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CH4 input rate

```{r}
#| label: ch4-input-rate-subregion

ch4_output <- 
  subregion_rate_comparison %>% select(subregion, contains("ch4_output"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(ch4_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### N2O input rate

```{r}
#| label: n2o-input-rate-subregion

n2o_input <- 
  subregion_rate_comparison %>% select(subregion, contains("n2o_input"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(n2o_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2e input rate

```{r}
#| label: co2e-input-rate-subregion

co2e_input <- 
  subregion_rate_comparison %>% select(subregion, contains("co2e_input"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e input rate (lb/MMBtu)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2e_input,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

### Combustion output emission rate comparison

::: panel-tabset
#### NOx combustion output rate

```{r}
#| label: nox-combustion-rate-subregion

nox_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = nox_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### NOx ozone combustion output rate

```{r}
#| label: nox-oz-combustion-rate-subregion

nox_oz_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("nox_oz_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion,
                                                y = nox_oz_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_oz_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### SO2 combustion output rate

```{r}
#| label: so2-combustion-rate-subregion

so2_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("so2_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = so2_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(so2_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2 combustion output rate

```{r}
#| label: co2-combustion-rate-subregion

co2_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("co2_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2_combustion,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CH4 combustion output rate

```{r}
#| label: ch4-combustion-rate-subregion

ch4_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("ch4_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = ch4_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(ch4_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### N2O combustion output rate

```{r}
#| label: n2o-combustion-rate-subregion

n2o_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("n2o_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = n2o_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(n2o_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2e combustion output rate

```{r}
#| label: co2e-combustion-rate-subregion

co2e_combustion <- 
  subregion_rate_comparison %>% select(subregion, contains("co2e_combustion"), generation_notes)

rate_comparison <- ggplot(subregion_us_comparison, aes(x = subregion, 
                                                y = co2e_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e combustion output rate (lb/MWh)") + 
                    xlab("eGRID Subregion") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2e_combustion,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("Subregion", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

## State

Compare state emission rates from `r prev_yr3` to `r params$eGRID_year` and percent change from `r prev_yr1` to `r params$eGRID_year`.

### Output emission rate comparison

::: panel-tabset
#### NOx output rate

```{r}
#| label: nox-output-rate-state

nox_output <- 
  state_rate_comparison %>% 
  select(state, contains("nox_output"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 70)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### NOx ozone output rate

```{r}
#| label: nox-oz-output-rate-state

nox_oz_output <- 
  state_rate_comparison %>% select(state, contains("nox_oz_output"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_oz_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### SO2 output rate

```{r}
#| label: so2-output-rate-state

so2_output <- 
  state_rate_comparison %>% select(state, contains("so2_output"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(so2_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent Change",
                           "Notes")) 
```

#### CO2 output rate

```{r}
#| label: co2-output-rate-state

co2_output <- 
  state_rate_comparison %>% select(state, contains("co2_output"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2_output,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CH4 output rate

```{r}
#| label: ch4-output-rate-state

ch4_output <- 
  state_rate_comparison %>% select(state, contains("ch4_output"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state,
                                                y = ch4_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(ch4_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### N2O output rate

```{r}
#| label: n2o-output-rate-state

n2o_output <- 
  state_rate_comparison %>% select(state, contains("n2o_output"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state,
                                                y = n2o_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(n2o_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2e output rate

```{r}
#| label: co2e-output-rate-state

co2e_output <- 
  state_rate_comparison %>% select(state, contains("co2e_output"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_output_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2e_output,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

### Input emission rate comparison

::: panel-tabset
#### NOx input rate

```{r}
#| label: nox-input-rate-state

nox_input <- 
  state_rate_comparison %>% select(state, contains("nox_input"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_input_rate,
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### NOx ozone input rate

```{r}
#| label: nox-input-oz-rate-state

nox_oz_input <- 
  state_rate_comparison %>% select(state, contains("nox_oz_input"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_oz_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_oz_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### SO2 input rate

```{r}
#| label: so2-input-rate-state

so2_input <- 
  state_rate_comparison %>% select(state, contains("so2_input"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(so2_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2 input rate

```{r}
#| label: co2-input-rate-state

co2_input <- 
  state_rate_comparison %>% select(state, contains("co2_input"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state,
                                                y = co2_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2_input,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CH4 input rate

```{r}
#| label: ch4-input-rate-state

ch4_output <- 
  state_rate_comparison %>% select(state, contains("ch4_output"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(ch4_output,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### N2O input rate

```{r}
#| label: n2o-input-rate-state

n2o_input <- 
  state_rate_comparison %>% select(state, contains("n2o_input"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(n2o_input,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2e input rate

```{r}
#| label: co2e-input-rate-state

co2e_input <- 
  state_rate_comparison %>% select(state, contains("co2e_input"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_input_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e input rate (lb/MMBtu)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2e_input,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::

### Combustion output emission rate comparison

::: panel-tabset
#### NOx combustion output rate

```{r}
#| label: nox-combustion-rate-state

nox_combustion <- 
  state_rate_comparison %>% select(state, contains("nox_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = nox_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### NOx ozone combustion output rate

```{r}
#| label: nox-oz-combustion-rate-state

nox_oz_combustion <- 
  state_rate_comparison %>% select(state, contains("nox_oz_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state,
                                                y = nox_oz_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("NOx ozone combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(nox_oz_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### SO2 combustion output rate

```{r}
#| label: so2-combustion-rate-state

so2_combustion <- 
  state_rate_comparison %>% select(state, contains("so2_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = so2_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("SO2 combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(so2_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2 combustion output rate

```{r}
#| label: co2-combustion-rate-state

co2_combustion <- 
  state_rate_comparison %>% select(state, contains("co2_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2 combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2_combustion,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CH4 combustion output rate

```{r}
#| label: ch4-combustion-rate-state

ch4_combustion <- 
  state_rate_comparison %>% select(state, contains("ch4_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = ch4_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CH4 combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(ch4_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### N2O combustion output rate

```{r}
#| label: n2o-combustion-rate-state

n2o_combustion <- 
  state_rate_comparison %>% select(state, contains("n2o_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = n2o_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("N2O combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(n2o_combustion,
             digits = c(0, 3, 3, 3, 3, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```

#### CO2e combustion output rate

```{r}
#| label: co2e-combustion-rate-state

co2e_combustion <- 
  state_rate_comparison %>% select(state, contains("co2e_combustion"), generation_notes)

rate_comparison <- ggplot(state_comparison, aes(x = state, 
                                                y = co2e_combustion_rate, 
                                                fill = year)) +
                    geom_bar(stat = "identity", 
                             width = 0.75,
                             position = "dodge") +
                    ylab("CO2e combustion output rate (lb/MWh)") + 
                    xlab("State") + 
                    theme(text = element_text(size = 12), 
                          axis.text.x = element_text(angle = 45)) 
  
plotly::ggplotly(rate_comparison)

knitr::kable(co2e_combustion,
             digits = c(0, 0, 0, 0, 0, 2),
             format.args = list(big.mark = ","),
             col.names = c("State", 
                           as.character(prev_yr3), 
                           as.character(prev_yr2),
                           as.character(prev_yr1), 
                           as.character(cur_year), 
                           "Percent change", 
                           "Notes")) 
```
:::


-   include nonbaseload outut rates for both subregion and state levels
-   include fuel-specific input emission rates and output emission rates for both subgregion and state level
-   

# Resource mix comparison

-   move graphs to able

## US resource mix

::: panel-tabset
### US resource mix table

```{r}
#| label: US-resource-mix-table 
 
knitr::kable(us_resource_mix_formatted,
             digits = 2, 
             format.args = list(big.mark = ","), 
             col.names = gsub("[_]", " ", names(us_resource_mix_formatted))) %>%
  row_spec(1, background = "#ffefd5") %>% 
  column_spec(6,
              background = case_when(us_resource_mix_formatted$percent_change 
                                     > 0 ~ "#e9ffdb", 
                                     us_resource_mix_formatted$percent_change 
                                     == 0 ~ "#dcdcdc", 
                                     us_resource_mix_formatted$percent_change 
                                     < 0 ~ "#f7bfbe"), 
              color = case_when(us_resource_mix_formatted$percent_change 
                                > 0 ~ "#013220", 
                                us_resource_mix_formatted$percent_change 
                                == 0 ~ "#000000", 
                                us_resource_mix_formatted$percent_change 
                                < 0 ~ "#860111"))  
  
```

### US resource mix figure

```{r}
#| label: US-resource-mix-figure
 

resource_comparison <-    
  ggplot(us_resource_mix, 
         aes(x = energy_source_generation / 1000,               
           y = reorder(energy_source, energy_source_generation), fill = year)) +
  geom_bar(stat = "identity",
           width = 0.75,
           position = "dodge") +   
  xlab("Generation (GWh)") +    
  ylab("Energy source") +    
  theme(text = element_text(size = 12))     

plotly::ggplotly(resource_comparison)
```
:::

## eGRID subregion resource mix

::: panel-tabset
### AKGD

```{r}
#| label: AKGD-summary

source("scripts/functions/function_region_summary.R")

create_cap_table_subregion("AKGD", c(prev_yr1, cur_year))
create_resource_table_subregion("AKGD", c(prev_yr1, cur_year))
create_resource_plot_subregion("AKGD", c(prev_yr1, cur_year))
```

### AKMS

```{r}
#| label: AKMS-summary

create_cap_table_subregion("AKMS", c(prev_yr1, cur_year))
create_resource_table_subregion("AKMS", c(prev_yr1, cur_year))
create_resource_plot_subregion("AKMS", c(prev_yr1, cur_year))
```

### AZNM

```{r}
#| label: AZNM-summary

create_cap_table_subregion("AZNM", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("AZNM", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("AKMS", 
                           c(prev_yr1, cur_year))
```

### CAMX

```{r}
#| label: CAMX-summary

create_cap_table_subregion("CAMX", c(prev_yr1, cur_year))
create_resource_table_subregion("CAMX", c(prev_yr1, cur_year))
create_resource_plot_subregion("CAMX", c(prev_yr1, cur_year))
```

### ERCT

```{r}
#| label: ERCT-summary

create_cap_table_subregion("ERCT", c(prev_yr1, cur_year))
create_resource_table_subregion("ERCT", c(prev_yr1, cur_year))
create_resource_plot_subregion("ERCT", c(prev_yr1, cur_year))
```

### FRCC

```{r}
#| label: FRCC-summary

create_cap_table_subregion("FRCC", c(prev_yr1, cur_year))
create_resource_table_subregion("FRCC", c(prev_yr1, cur_year))
create_resource_plot_subregion("FRCC", c(prev_yr1, cur_year))
```

### HIMS

```{r}
#| label: HIMS-summary

create_cap_table_subregion("HIMS", c(prev_yr1, cur_year))
create_resource_table_subregion("HIMS", c(prev_yr1, cur_year))
create_resource_plot_subregion("HIMS", c(prev_yr1, cur_year))
```

### HIOA

```{r}
#| label: HIOA-summary

create_cap_table_subregion("HIOA", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("HIOA", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("HIOA", 
                           c(prev_yr1, cur_year))
```

### MROE

```{r}
#| label: MROE-summary

create_cap_table_subregion("MROE", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("MROE", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("MROE", 
                           c(prev_yr1, cur_year))
```

### MROW

```{r}
#| label: MROW-summary

create_cap_table_subregion("MROW", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("MROW", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("MROW", 
                           c(prev_yr1, cur_year))
```

### NEWE

```{r}
#| label: NEWE-summary

create_cap_table_subregion("NEWE", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("NEWE", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("NEWE", 
                           c(prev_yr1, cur_year))
```

### NWPP

```{r}
#| label: NWPP-summary

create_cap_table_subregion("NWPP", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("NWPP", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("NWPP", 
                           c(prev_yr1, cur_year))
```

### NYCW

```{r}
#| label: NYCW-summary

create_cap_table_subregion("NYCW", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("NYCW", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("NYCW", 
                           c(prev_yr1, cur_year))
```

### NYLI

```{r}
#| label: NYLI-summary

create_cap_table_subregion("NYLI",
                       c(prev_yr1, cur_year))
create_resource_table_subregion("NYLI", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("NYLI", 
                           c(prev_yr1, cur_year))
```

### NYUP

```{r}
#| label: NYUP-summary

create_cap_table_subregion("NYUP", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("NYUP", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("NYUP", 
                           c(prev_yr1, cur_year))
```

### PRMS

```{r}
#| label: PRMS-summary

create_cap_table_subregion("PRMS", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("PRMS", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("PRMS", 
                           c(prev_yr1, cur_year))
```

### RFCE

```{r}
#| label: RFCE-summary

create_cap_table_subregion("RFCE", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("RFCE", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("RFCE", 
                           c(prev_yr1, cur_year))
```

### RFCM

```{r}
#| label: RFCM-summary

create_cap_table_subregion("RFCM", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("RFCM", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("RFCM", 
                           c(prev_yr1, cur_year))
```

### RFCW

```{r}
#| label: RFCW-summary

create_cap_table_subregion("RFCW", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("RFCW", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("RFCW", 
                           c(prev_yr1, cur_year))
```

### RMPA

```{r}
#| label: RMPA-summary

create_cap_table_subregion("RMPA", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("RMPA", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("RMPA", 
                           c(prev_yr1, cur_year))
```

### SPNO

```{r}
#| label: SPNO-summary

create_cap_table_subregion("SPNO", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SPNO", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("SPNO", 
                           c(prev_yr1, cur_year))
```

### SPSO

```{r}
#| label: SPSO-summary

create_cap_table_subregion("SPSO", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SPSO", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("SPSO", 
                           c(prev_yr1, cur_year))
```

### SRMV

```{r}
#| label: SRMV-summary

create_cap_table_subregion("SRMV", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SRMV", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("SRMV", 
                           c(prev_yr1, cur_year))
```

### SRSO

```{r}
#| label: SRSO-summary

create_cap_table_subregion("SRSO", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SRSO", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("SRSO", 
                           c(prev_yr1, cur_year))
```

### SRTV

```{r}
#| label: SRTV-summary

create_cap_table_subregion("SRTV", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SRTV", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("SRTV", 
                           c(prev_yr1, cur_year))
```

### SRVC

```{r}
#| label: SRVC-summary

create_cap_table_subregion("SRVC", 
                       c(prev_yr1, cur_year))
create_resource_table_subregion("SRVC", 
                            c(prev_yr1, cur_year))
create_resource_plot_subregion("SRVC", 
                           c(prev_yr1, cur_year))
```
:::

## State resource mix

::: panel-tabset
### AK

```{r}
#| label: AK-summary

create_cap_table_state("AK", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AK", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("AK", 
                           c(prev_yr1, cur_year))
```

### AL

```{r}
#| label: AL_summary

create_cap_table_state("AL", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AL", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("AL", 
                           c(prev_yr1, cur_year))
```

### AR

```{r}
#| label: AR-summary

create_cap_table_state("AR", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AR", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("AR", 
                           c(prev_yr1, cur_year))
```

### AZ

```{r}
#| label: AZ-summary

create_cap_table_state("AZ", 
                       c(prev_yr1, cur_year))
create_resource_table_state("AZ", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("AZ", 
                           c(prev_yr1, cur_year))
```

### CA

```{r}
#| label: CA-summary

create_cap_table_state("CA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("CA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("CA", 
                           c(prev_yr1, cur_year))
```

### CO

```{r}
#| label: CO-summary

create_cap_table_state("CO", 
                       c(prev_yr1, cur_year))
create_resource_table_state("CO", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("CO", 
                           c(prev_yr1, cur_year))
```

### CT

```{r}
#| label: CT-summary

create_cap_table_state("CT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("CT", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("CT", 
                           c(prev_yr1, cur_year))
```

### DC

```{r}
#| label: DC-summary

create_cap_table_state("DC", 
                       c(prev_yr1, cur_year))
create_resource_table_state("DC", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("DC", 
                           c(prev_yr1, cur_year))
```

### DE

```{r}
#| label: DE-summary

create_cap_table_state("DE", 
                       c(prev_yr1, cur_year))
create_resource_table_state("DE", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("DE", 
                           c(prev_yr1, cur_year))
```

### FL

```{r}
#| label: FL-summary

create_cap_table_state("FL", 
                       c(prev_yr1, cur_year))
create_resource_table_state("FL", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("FL", 
                           c(prev_yr1, cur_year))
```

### GA

```{r}
#| label: GA-summary

create_cap_table_state("GA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("GA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("GA", 
                           c(prev_yr1, cur_year))
```

### HI

```{r}
#| label: HI-summary

create_cap_table_state("HI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("HI", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("HI", 
                           c(prev_yr1, cur_year))
```

### IA

```{r}
#| label: IA-summary

create_cap_table_state("IA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("IA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("IA", 
                           c(prev_yr1, cur_year))
```

### ID

```{r}
#| label: ID-summary

create_cap_table_state("ID", 
                       c(prev_yr1, cur_year))
create_resource_table_state("ID", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("ID", 
                           c(prev_yr1, cur_year))
```

### IL

```{r}
#| label: IL-summary

create_cap_table_state("IL", 
                       c(prev_yr1, cur_year))
create_resource_table_state("IL", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("IL", 
                           c(prev_yr1, cur_year))
```

### IN

```{r}
#| label: IN-summary

create_cap_table_state("IN", 
                       c(prev_yr1, cur_year))
create_resource_table_state("IN", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("IN", 
                           c(prev_yr1, cur_year))
```

### KS

```{r}
#| label: KS-summary

create_cap_table_state("KS", 
                       c(prev_yr1, cur_year))
create_resource_table_state("KS", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("KS", 
                           c(prev_yr1, cur_year))
```

### KY

```{r}
#| label: KY-summary

create_cap_table_state("KY", 
                       c(prev_yr1, cur_year))
create_resource_table_state("KY", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("KY", 
                           c(prev_yr1, cur_year))
```

### LA

```{r}
#| label: LA-summary

create_cap_table_state("LA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("LA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("LA", 
                           c(prev_yr1, cur_year))
```

### MA

```{r}
#| label: MA-summary

create_cap_table_state("MA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MA", 
                           c(prev_yr1, cur_year))
```

### MD

```{r}
#| label: MD-summary

create_cap_table_state("MD", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MD", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MD", 
                           c(prev_yr1, cur_year))
```

### ME

```{r}
#| label: ME-summary

create_cap_table_state("ME", 
                       c(prev_yr1, cur_year))
create_resource_table_state("ME", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("ME", 
                           c(prev_yr1, cur_year))
```

### MI

```{r}
#| label: MI-summary

create_cap_table_state("MI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MI", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MI", 
                           c(prev_yr1, cur_year))
```

### MN

```{r}
#| label: MN-summary

create_cap_table_state("MN", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MN", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MN", 
                           c(prev_yr1, cur_year))
```

### MO

```{r}
#| label: MO-summary

create_cap_table_state("MO", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MO", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MO", 
                           c(prev_yr1, cur_year))
```

### MS

```{r}
#| label: MS-summary

create_cap_table_state("MS", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MS", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MS", 
                           c(prev_yr1, cur_year))
```

### MT

```{r}
#| label: MT-summary

create_cap_table_state("MT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("MT", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("MT", 
                           c(prev_yr1, cur_year))
```

### NC

```{r}
#| label: NC-summary

create_cap_table_state("NC", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NC", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NC", 
                           c(prev_yr1, cur_year))
```

### ND

```{r}
#| label: ND-summary

create_cap_table_state("ND", 
                       c(prev_yr1, cur_year))
create_resource_table_state("ND", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("ND", 
                           c(prev_yr1, cur_year))
```

### NE

```{r}
#| label: NE-summary

create_cap_table_state("NE", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NE", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NE", 
                           c(prev_yr1, cur_year))
```

### NH

```{r}
#| label: NH-summary

create_cap_table_state("NH", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NH", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NH", 
                           c(prev_yr1, cur_year))
```

### NJ

```{r}
#| label: NJ-summary

create_cap_table_state("NJ", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NJ", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NJ", 
                           c(prev_yr1, cur_year))
```

### NM

```{r}
#| label: NM-summary

create_cap_table_state("NM", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NM", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NM", 
                           c(prev_yr1, cur_year))
```

### NV

```{r}
#| label: NV-summary

create_cap_table_state("NV", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NV", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NV",
                           c(prev_yr1, cur_year))
```

### NY

```{r}
#| label: NY-summary

create_cap_table_state("NY", 
                       c(prev_yr1, cur_year))
create_resource_table_state("NY", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("NY", 
                           c(prev_yr1, cur_year))
```

### OH

```{r}
#| label: OH-summary

create_cap_table_state("OH", c(prev_yr1, cur_year))
create_resource_table_state("OH", c(prev_yr1, cur_year))
create_resource_plot_state("OH", c(prev_yr1, cur_year))
```

### OK

```{r}
#| label: OK-summary

create_cap_table_state("OK", 
                       c(prev_yr1, cur_year))
create_resource_table_state("OK", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("OK", 
                           c(prev_yr1, cur_year))
```

### OR

```{r}
#| label: OR-summary

create_cap_table_state("OR", 
                       c(prev_yr1, cur_year))
create_resource_table_state("OR", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("OR", 
                           c(prev_yr1, cur_year))
```

### PA

```{r}
#| label: PA-summary

create_cap_table_state("PA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("PA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("PA", 
                           c(prev_yr1, cur_year))
```

### PR

```{r}
#| label: PR-summary

create_cap_table_state("PR", 
                       c(prev_yr1, cur_year))
create_resource_table_state("PR", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("PR", 
                           c(prev_yr1, cur_year))
```

### RI

```{r}
#| label: RI-summary

create_cap_table_state("RI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("RI", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("RI", 
                           c(prev_yr1, cur_year))
```

### SC

```{r}
#| label: SC-summary

create_cap_table_state("SC", 
                       c(prev_yr1, cur_year))
create_resource_table_state("SC", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("SC", 
                           c(prev_yr1, cur_year))
```

### SD

```{r}
#| label: SD-summary

create_cap_table_state("SD", 
                       c(prev_yr1, cur_year))
create_resource_table_state("SD", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("SD", 
                           c(prev_yr1, cur_year))
```

### TN

```{r}
#| label: TN-summary

create_cap_table_state("TN", 
                       c(prev_yr1, cur_year))
create_resource_table_state("TN", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("TN", 
                           c(prev_yr1, cur_year))
```

### TX

```{r}
#| label: TX-summary

create_cap_table_state("TX", 
                       c(prev_yr1, cur_year))
create_resource_table_state("TX", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("TX", 
                           c(prev_yr1, cur_year))
```

### UT

```{r}
#| label: UT-summary

create_cap_table_state("UT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("UT", c(prev_yr1, cur_year))
create_resource_plot_state("UT", c(prev_yr1, cur_year))
```

### VA

```{r}
#| label: VA-summary

create_cap_table_state("VA", c(prev_yr1, cur_year))
create_resource_table_state("VA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("VA", 
                           c(prev_yr1, cur_year))
```

### VT

```{r}
#| label: VT-summary

create_cap_table_state("VT", 
                       c(prev_yr1, cur_year))
create_resource_table_state("VT", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("VT", 
                           c(prev_yr1, cur_year))
```

### WA

```{r}
#| label: WA-summary

create_cap_table_state("WA", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WA", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("WA", 
                           c(prev_yr1, cur_year))
```

### WI

```{r}
#| label: WI-summary

create_cap_table_state("WI", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WI", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("WI", 
                           c(prev_yr1, cur_year))
```

### WV

```{r}
#| label: WV-summary

create_cap_table_state("WV", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WV", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("WV", 
                           c(prev_yr1, cur_year))
```

### WY

```{r}
#| label: WY-summary

create_cap_table_state("WY", 
                       c(prev_yr1, cur_year))
create_resource_table_state("WY", 
                            c(prev_yr1, cur_year))
create_resource_plot_state("WY", 
                           c(prev_yr1, cur_year))
```
:::

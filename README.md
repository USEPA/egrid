# eGRID

This repository includes all necessary scripts and documentation to create the [Emissions & Generation Resource Integrated Database (eGRID)](https://www.epa.gov/egrid). 

## Background

eGRID is a comprehensive source of data from EPA's Clean Air Markets Program Data (CAMPD) on the environmental characteristics of almost all electric power generated in the United States. The preeminent source of emissions data for the electric power sector, eGRID is based on available plant-specific data for all U.S. electricity generating plants that provide power to the electric grid and report data to the U.S. government. Data reported include, but are not limited to, net electric generation; resource mix (for renewable and nonrenewable generation); mass emissions of carbon dioxide (CO2), nitrogen oxides (NOx), sulfur dioxide (SO2), methane (CH4), nitrous oxide (N2O), and mercury (Hg); emission rates for CO2, NOx, SO2, CH4, and N2O; heat input; and nameplate capacity. eGRID reports this information on an annual basis (as well as by ozone season for NOx) at different levels of aggregation.

The data includes emissions, emission rates, generation, heat input, resource mix, and many other attributes. eGRID is typically used for greenhouse gas registries and inventories, carbon footprints, consumer information disclosure, emission inventories and standards, power market changes, and avoided emission estimates.

The final eGRID dataset includes eight levels of data aggregation:

-   **Generator**: Generators connected to the U.S. electricity grid. A generator is defined as a unit that produces electricity.

-   **Unit**: Units connected to the U.S. electricity grid. A unit is defined in eGRID as either a generator (produces electricity) or a boiler (uses fuel to heat water and produce steam). 

-   **Plant**: Plants connected to the U.S. electricity grid. 

-   **State**: U.S. states, Puerto Rico (PR), and District of Columbia (DC).

-   **Balancing authority**: Regional operators that ensure a balance of supply and demand. 

-   **eGRID subregion**: EPA defined subregions defined to limit import and export of electricity. 

-   **NERC (North American Electric Reliability Corporation) regions**: Regional reliability entities. eGRID also include Alaska, Hawaii, and Puerto Rico as their own NERC region.  

-   **U.S.**

Further information on eGRID methodology can be found in the [eGRID Technical Guide](https://www.epa.gov/egrid/egrid-technical-guide).

The dataset that this code produces is publicly available [here](https://www.epa.gov/egrid/download-data).

## Code Base Organization

This project is structured as an RStudio project. To ensure that all scripts run correctly, load the `eGRID_R.Rproj` within RStudio to enable the project environment. `eGRID_master.qmd` is a Quarto document that serves as a master script (i.e., it runs all necessary scripts in the correct order), while also providing documentation for the scripts and steps performed therein. 

The code base is structured as follows: 

 -  `scripts/`: all scripts to download and clean data, create each data aggregation level, format final dataset, and convert to metric units. 
 
 -  `scripts/functions/`: all helper functions. 
 
 -  `data/raw_data/`: raw data obtained from EPA and EIA sites. 
 
 -  `data/clean_data/`: data created from EPA and EIA data cleaning steps. 
 
 -  `data/outputs/`: outputs generated by this code base. 
 
 -  `data/static_tables/`: static tables used within the code base. These include crosswalks that match data between EIA and EPA data or regions and manual corrections that are made. 

The data used to create eGRID are EIA and EPA electricity data. EPA data are loaded via an API in `scripts/data_load_camd.R` and cleaned in `scripts/data_clean_camd.R`. EIA data are downloaded from EIA's website in `scripts/data_load_eia.R` and `scripts/functions/function_download_eia_files.R` and cleaned in `scripts/data_clean_eia.R`. 


## Creating eGRID

To create the eGRID dataset: 

1. Obtain an API key for EPA data. 
    a. Request an API key from https://www.epa.gov/power-sector/cam-api-portal.
    b. Create folder `api_keys/` within the root of the eGRID.
    c. Create a text file named `camd_api_key.txt` within the folder `api_keys/` and save the API key here on a single line.
2. Load `eGRID_R.Rproj` within RStudio to enable the project environment.
3. Render `eGRID_master.qmd`. 
    a. Set data year in `params` (eGRID_year) in the YAML as a string in the format "YYYY" (ex: `"2023"`).
    b. Render `eGRID_master.qmd`. This will run all scripts and build the eGRID dataset. 

## Outputs

The codebase outputs each data aggregation level in the eGRID dataset as an .RDS file and the final dataset as an Excel sheet in `data/outputs/{params$eGRID_year}`. Rendering `eGRID_master.qmd` also creates an HTML file that summarizes the data, methods, and output files 
used and created throughout the code base. 

## Contributing to eGRID 

Please submit any questions about the eGRID dataset to [this web form](https://www.epa.gov/egrid/forms/contact-us-about-egrid).

If you would like to ask a question about or report an issue in the code, review the CONTRIBUTING policy and submit an issue under the "Issues" tab in the GitHub repository. Provide a concise summary as the title of the issue and a clear description, including steps to reproduce the issue. 

## Disclaimer

The United States Environmental Protection Agency (EPA) GitHub project code is provided on an "as is" basis and the user assumes responsibility for its use.  EPA has relinquished control of the information and no longer has responsibility to protect the integrity , confidentiality, or availability of the information.  Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation or favoring by EPA.  The EPA seal and logo shall not be used in any manner to imply endorsement of any commercial product or activity by EPA or the United States Government.
